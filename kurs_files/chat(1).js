try{if(void 0!==y3Qc6aR)throw new Error("Czater script loaded twice");var Rf2jK5f=!1,showChat,hideChat,tries=0,socket=!1,y3Qc6aR,e3D18r_czater={},$czaterMethods={};const bots={FAQ:"FAQ",DIALOGFLOW:"DIALOGFLOW",SENTIONE:"SENTIONE"};!function(){var interval=null,czaterEvents=!1,czaterSR=!1,titleInterval=!1,originTitle=document.title,titleSemaphore=!1,previousMessagesLoaded=!1,myCache=("undefined"==typeof httpRef&&(httpRef=!1),{currentCache:0,constants:{timestamp:"e3D18r_cache_timestamp",language:"e3D18r_cache_language",template:"e3D18r_cache_template",callLangs:"e3D18r_cache_call_langs",callCountries:"e3D18r_cache_call_countries",exclusionsDesktop:"e3D18r_cache_exclusionsDesktop",exclusionsMobile:"e3D18r_cache_exclusionsMobile"},setNewCacheTimestamp:function(e){var t=e3D18r_czater.sessionStorage.getItem(this.constants.timestamp);Number(e)!==Number(t)&&(this.clearCaches(),e3D18r_czater.sessionStorage.setItem(this.constants.timestamp,e))},getCache:function(e){e=e3D18r_czater.sessionStorage.getItem(e);return!!e&&JSON.parse(e)},setCache:function(e,t){e3D18r_czater.sessionStorage.setItem(e,JSON.stringify(t))},clearCaches:function(){var t=this;Object.keys(this.constants).forEach(function(e){e3D18r_czater.sessionStorage.removeItem(t.constants[e])})}}),main,destroy;function startTitleInterval(){function e(e){titleSemaphore||(titleSemaphore=!0,originTitle=document.title,document.title=e,setTimeout(function(){document.title=originTitle,titleSemaphore=!1},2e3))}var t="";e(t+="pol"===lang?"Konsultant pisze...":"The consultant writes..."),titleInterval&&(clearInterval(titleInterval),titleInterval=!1),titleInterval=setInterval(function(){e(t)},6e3)}function stopTitleInterval(){titleInterval&&(clearInterval(titleInterval),titleInterval=!1),document.title=originTitle,titleSemaphore=!1}void 0===window.main&&(window.main=function(){"function"==typeof main&&loadScript(src,main)}),$czaterMethods.main=function(){"function"==typeof main&&loadScript(src,main)},void 0===window.destroy&&(window.destroy=function(){"function"==typeof destroy&&destroy()});var localStorageTest=!0;try{localStorage.getItem("testLocalStorage")}catch(error){console.log(error),localStorageTest=!1}"localStorage"in window&&0!=localStorageTest?(e3D18r_czater.localStorage=localStorage,e3D18r_czater.sessionStorage=sessionStorage):(e3D18r_czater.localStorage={_data:{},setItem:function(e,t){return this._data[e]=String(t)},getItem:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0},removeItem:function(e){return delete this._data[e]},clear:function(){return this._data={}}},e3D18r_czater.sessionStorage={length:0,setItem:function(e,t){document.cookie=e+"="+t+"; path=/",this.length++},getItem:function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0,o=a.length;n<o;n++){for(var i=a[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null},removeItem:function(e){this.setItem(e,"",-1),this.length--},key:function(e){var t=document.cookie.split(";");if(e>=t.length||isNaN(parseFloat(e))||!isFinite(e))return null;for(var a=t[e];" "===a.charAt(0);)a=a.substring(1,a.length);return a.substring(0,a.indexOf("="))}});var w4Ue7Lb={pl:["","pol","polish"],de:["_de","deu","german"],fr:["_fr","fra","french"],es:["_es","spa","spanish"],ru:["_ru","rus","russian"],sv:["_sv","swe","swedish"],ro:["_ro","rom","romanian"],el:["_el","grc","greek"],cs:["_cs","ces","czech"],sk:["_sk","slk","slovak"],bg:["_bg","bul","bulgarian"],nl:["_nl","nld","dutch"],it:["_it","ita","italian"],pt:["_pt","por","portuguese"],en:["_en","eng","english"],uk:["_uk","ukr","ukrainian"],hu:["_hu","hun","hungarian"],no:["_no","nob","norwegian"],lv:["_lv","lav","latvian"],lt:["_lt","lit","lithuanian"]};function doCloseConversation(){slideToggle(),convInProgress=messagesCount=0,socket.emit("ToServerCloseConversation",{adminHash:window.$czater.tok,chatHash:chatHash,whoClose:"client",sendSurvey:!0}),-1<window.location.href.indexOf("getChatWindowed")&&window.close()}function getCookie(t){return document.cookie.split(";").some(e=>e.trim().startsWith(t+"="))}function deleteCookie(e,t,a){getCookie(e)&&(document.cookie=e+"="+(t?";path="+t:"")+(a?";domain="+a:"")+";expires=Thu, 01 Jan 1970 00:00:01 GMT")}function callIfUserLeaves(e){var t=!1,n=!1,o=function(){n&&!t&&(t=!0,document.removeEventListener("mousemove",a),e())},a=function(e){var t=window.innerHeight,a=e.movementY,e=e.clientY;a<0&&e<t/10?(n=!0,document.addEventListener("mouseout",o)):(n=!1,document.removeEventListener("mouseleave",o))};setTimeout(function(){document.addEventListener("mousemove",a)},1e3)}function callIfUserScrolls(e,t){var a=function(){window.scrollY>=e&&(removeEventListener("scroll",a),t())};addEventListener("scroll",a)}if(window.$czater&&void 0===y3Qc6aR&&window.$czater.tok){y3Qc6aR=!0;var base_url=static_url="https://www.czater.pl/",w=(window.$czater.domain&&(base_url=window.$czater.domain),screen.width),h=screen.height,srcRecorder="assets/modules/chat/js/recorder.js",srcCall="assets/modules/chat/js/czatercall.js",recordingInterval=!1,liveInterval=!1,allowSend=!0,recorder=!1,calling=!1,isSections=0,absolutelyFirst=!0,randomizeTime=!1,ifKruk=0,googleAnalytics=0,liveInterval=!1,ip="127.0.0.1",portFix,hideBrand=!1,port="",switch_from_bot="",previousStatusData={},date2str=(!function(){var e=window.$czater.tok.charCodeAt(0);portFix=e>="0".charCodeAt(0)&&e<="3".charCodeAt(0)||0<=base_url.indexOf("czaterdev.pl")?"s1":e>="4".charCodeAt(0)&&e<="7".charCodeAt(0)?"s2":e>="8".charCodeAt(0)&&e<="b".charCodeAt(0)?"s3":"s4",port+=portFix}(),function(date,format){var z={M:date.getMonth()+1,d:date.getDate(),h:date.getHours(),m:date.getMinutes(),s:date.getSeconds()};return format=format.replace(/(M+|d+|h+|m+|s+)/g,function(v){return((1<v.length?"0":"")+eval("z."+v.slice(-1))).slice(-2)}),format.replace(/(y+)/g,function(e){return date.getFullYear().toString().slice(-e.length)})}),isRecording=!0,recId=!1,exclusion=!1,referer=document.URL,canGetUserStatus=!1,canGetTemplate=!1,frameLoadedDetail=!1,triesInterval=null,internetInterval=null,testInterval=null,connectionsInterval=null,currentUrlInterval=null,mainLoaded=!1,maxTries=4,socketConnected=!1,firstEnter=!0,firstCookie=!0,firstRefererSent=!0,firstSettingsSent=!0,always=0,urls=[],cssLoaded=!1,allTriggers=[],showTitle=0,username=null,welcomeCloseSelect,triggerWelcomeSelect,isBot=!1,receivedByConsultant=!1,clientCustomFields=!1,chatbotsForms=[],socket_path=!1,parts=(-1<base_url.indexOf("czat.kruksa.pl")?socket_url="https://s01.czat.kruksa.pl/":-1<base_url.indexOf("chat.it.kruk.eu")?socket_url="https://s1it.chaterbiz.com/":-1<base_url.indexOf("chat.es.kruk.eu")?socket_url="https://s1es.chaterbiz.com/":-1<base_url.indexOf("servizioclienti.chat")?socket_url="https://s2.olog.pl/":-1<base_url.indexOf("olog.pl")||-1<base_url.indexOf("olog.biz")?socket_url="https://s4.olog.pl/":-1<base_url.indexOf("qlog.pl")||-1<base_url.indexOf("qlog.biz")?socket_url="https://"+port+".qlog.pl/":-1<base_url.indexOf("czater.pl")||-1<base_url.indexOf("chater.biz")||-1<base_url.indexOf("chater.app")?socket_url="https://"+port+".czater.pl/":-1<base_url.indexOf("rc.chater.pl")?socket_url="https://"+port+"-rc.chater.pl/":-1<base_url.indexOf("chater.pl")||-1<base_url.indexOf("chaterbiz.com")?socket_url="https://"+port+".chater.pl/":-1<base_url.indexOf("czaterdev.pl")&&-1<base_url.indexOf("https")?socket_url="https://"+port+".czaterdev.pl/":-1<base_url.indexOf("live-chat.pl")&&-1<base_url.indexOf("https")?socket_url="https://"+port+".live-chat.pl/":-1<base_url.indexOf("callchat.pl")&&-1<base_url.indexOf("https")&&(socket_url="https://"+port+".callchat.pl/"),base_url.split(".")),COOKIE_SITE=(parts.shift(),parts.join(".")),createCookie=("/"===COOKIE_SITE[COOKIE_SITE.length-1]&&(COOKIE_SITE="."+COOKIE_SITE.substring(0,COOKIE_SITE.length-1)),function(e,t,a){var n,o="";a&&((n=new Date).setTime(n.getTime()+24*a*60*60*1e3),o="; expires="+n.toGMTString()),document.cookie=e+"="+t+o+"; path=/"}),readCookie=function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var o=a[n];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null},chatLoaded=!1,anotherTab=!1,templateLoaded=!1,templateData=!1,currentWidget=!1,language=encodeURIComponent(window.navigator.userLanguage||window.navigator.language),timestamp=11,notAutoCreate=!1,additionParams=(window.$czater.not_auto_create&&(notAutoCreate=window.$czater.not_auto_create),!1),chatHash=(window.$czater.addition_params&&(additionParams=window.$czater.addition_params),""),forceCookie=!1,autoOpen=(window.$czater.forceCookie&&(forceCookie=window.$czater.forceCookie,chatHash=forceCookie,window.$czater.chatHash=chatHash),!1),allowAutoOpen=(window.$czater.autoOpen&&(autoOpen=window.$czater.autoOpen),!0),set_windowed=(void 0!==window.$czater.allowAutoOpen&&(allowAutoOpen=window.$czater.allowAutoOpen),!1),set_minimized_button=(window.$czater.windowed&&(set_windowed=window.$czater.windowed),!1),set_chat_color=(window.$czater.minimized_button&&(set_minimized_button=window.$czater.minimized_button),!1),set_message_color=(window.$czater.chat_color&&(set_chat_color=window.$czater.chat_color),!1),set_button_color=(window.$czater.message_color&&(set_message_color=window.$czater.message_color),!1),patron=(window.$czater.button_color&&(set_button_color=window.$czater.button_color),!1),userLogin=(window.$czater.patron&&(patron=window.$czater.patron),!1),userEmail=(window.$czater.login&&(userLogin=window.$czater.login),!1),idSectionDefault=(window.$czater.email&&(userEmail=window.$czater.email),!1),userSection=(window.$czater.idSectionDefault&&(idSectionDefault=window.$czater.idSectionDefault),!1),czaterCallbackUserSection=!1,forceBot=(isNaN(window.$czater.section)||(userSection=window.$czater.section,czaterCallbackUserSection=window.$czater.section),!1),set_button_hover_color=(window.$czater.forceBot&&(forceBot=window.$czater.forceBot),window.$czater.sectionCallback&&(czaterCallbackUserSection=window.$czater.sectionCallback),!1),set_button_text_color=(window.$czater.button_hover_color&&(set_button_hover_color=window.$czater.button_hover_color),!1),set_chat_position=(window.$czater.button_text_color&&(set_button_text_color=window.$czater.button_text_color),!1),set_chat_mobile_position=(window.$czater.chat_position&&(set_chat_position=window.$czater.chat_position),!1),set_css_template=(window.$czater.chat_mobile_position&&(set_chat_mobile_position=window.$czater.chat_mobile_position),!1),allegroReferer=(window.$czater.css_template&&(set_css_template=window.$czater.css_template),""),forceOffline=(void 0!==window.$czater.allegroReferer&&(allegroReferer=window.$czater.allegroReferer),!1),forceCallback=(void 0!==window.$czater.forceOffline&&(forceOffline=window.$czater.forceOffline),!1),overwriteAdvertHeader=(void 0!==window.$czater.forceCallback&&(forceCallback=window.$czater.forceCallback),""),overwriteAdvertText=(void 0!==window.$czater.overwriteAdvertHeader&&(overwriteAdvertHeader=window.$czater.overwriteAdvertHeader),""),overwriteWelcomeMessage=(void 0!==window.$czater.overwriteAdvertText&&(overwriteAdvertText=window.$czater.overwriteAdvertText),""),overwriteWelcomeOnline=(void 0!==window.$czater.overwriteWelcomeMessage&&(overwriteWelcomeMessage=window.$czater.overwriteWelcomeMessage),void 0),overwriteWelcomeOffline=(void 0!==window.$czater.overwriteWelcomeOnline&&(overwriteWelcomeOnline=window.$czater.overwriteWelcomeOnline),void 0),clientPerDomain=(void 0!==window.$czater.overwriteWelcomeOffline&&(overwriteWelcomeOffline=window.$czater.overwriteWelcomeOffline),void 0!==window.$czater.language&&(language=window.$czater.language),!1),chatOpenMode=(void 0!==window.$czater.client_per_domain&&(clientPerDomain=window.$czater.client_per_domain),"auto"),allowMobileBack=(void 0!==window.$czater.chat_open_mode&&(chatOpenMode=window.$czater.chat_open_mode),!1),videoWindowed=(void 0!==window.$czater.allow_mobile_back&&(allowMobileBack=window.$czater.allow_mobile_back),!1),externalCSS=(void 0!==window.$czater.videoWindowed&&(videoWindowed=window.$czater.videoWindowed),[]),excluded=(void 0!==window.$czater.external_css&&(externalCSS=window.$czater.external_css),!1),open=!1,incactiveFor=0,lang="pol",welcomeMsg=null,welcome_offlineMsg=null,sectionsStatus=null,chosenSection=null,windowedPressed=!1,firstReferer="",userStatus="offline",isAvatar=!1,initializeConversation=!1,newLayout=0,iframeWindow=null,convInProgress=0,simpleStatus=null===e3D18r_czater.localStorage.getItem("simpleStatus")&&!1===patron?1:0,cookie_prefix="czater",cookie_name="__",cookie_open="__open2_"+window.$czater.tok,cookie_lastMessage="__last-message",cookie_firstReferer="__first-referer",cookie_lastReferer="__first-referer",teaser_shown="__teaser_shown",cookie_teaser_closed="__teaser-closed",cookie_trigger_used="__teaser-closed",cookie_last_section="__last-section",cookie_client_logged="__client-logged-"+window.$czater.tok,client_email="",client_name="",eventsStarted=!1,tempHash="",windowedUrl="",CookieTTL=365,idConsultant=null,minimizePressed=!1,alreadyStarted=!0,head,body,messagesCount=0,button_online="",header_online="",header_offline="",avatar_online="",chat_color="",text_msg_color="",rounded_corners="",chat_position="",chat_mobile_position="",chatInvitationPosition="",avatar_position="",marking="",noViewPort=!1,intervalMinimizePressed=null,intervalUpdateStatus=null,teaser_timeout=null,chatUnreadBadge="",clientRegister=0,clientRegisterAgreement="",tempHash=(window.token=!0,readCookie(cookie_prefix+cookie_name+window.$czater.tok)),firstReferer=(null===tempHash&&(tempHash=""),readCookie(cookie_prefix+cookie_firstReferer)),isTeaserClosed=(null===firstReferer&&(firstReferer=document.referrer,createCookie(cookie_prefix+cookie_firstReferer,firstReferer,CookieTTL)),null!==readCookie(cookie_prefix+cookie_teaser_closed)),lastMessage=readCookie(cookie_prefix+cookie_lastMessage),classAttr,headerClass,all=null,iframeNewMessage=!1,iframeParent=!1,header,unreadMessagesCount=null,unreadBadge,status,avatar,headerMSG,contener,teaser,czatercall_teaser,czatercall_teaser_caption,contenerTeaserCaption,countNewMessages,windowed,minimize,closeConversation,closeConversationMenu,contenerTeaserClose,czaterReturn,on=(window.addEventListener("frameLoaded",function(e){frameLoadedDetail=e.detail},!1),window.addEventListener("message",WindowMessageListener,!1),window.addEventListener("dragenter",function(){postMessage("drag",!1)},!1),window.addEventListener("dragover",function(){postMessage("drag",!1)},!1),window.addEventListener("dragleave",function(){postMessage("drag",!0)},!1),window.addEventListener("drop",function(){postMessage("drag",!0)},!1),"addEventListener"in window?function(e,t,a){e&&e.addEventListener(t,a,!1)}:function(e,t,a){e&&e.attachEvent("on"+t,function(){a(window.event)})}),showChatWindowed=(showChat=function(e,t){updateUnreadMessages("hide"),"off"===contener.getAttribute("data-display")&&(previousMessagesLoaded||(previousMessagesLoaded=!0,window.postMessage(JSON.stringify({type:"getPrevMessages",value:{idSection:chosenSection,lastMessageId:0}}),"*")),allowMobileBack&&isMobile.any()&&(window.location="#chat-window-open"),contener.setAttribute("data-anim","off"),czaterEvents.sendEvent("showChat"),czaterSR.sendCustomRequest(1,"czater_opened-chat-window",{})),e=void 0===e||e,t=void 0!==t&&t,triggerWelcomeSelect&&(all.querySelector("#trigger-welcome").classList.add("hidden"),all.querySelector("#trigger-welcome").style.display="none"),showChatInside=function(){contener.removeAttribute("data-anim"),contener.setAttribute("data-anim","on"),isMobile.any()&&"offline"===userStatus&&window.scrollTo(0,0),createCookie(cookie_prefix+cookie_open,"1",1),isMobile.any()&&window.innerWidth<window.innerHeight?contener.style.height=window.innerHeight-5+"px":contener.style.height=2==newLayout?"590px":3==newLayout?"600px":0===newLayout?"540px":"550px",contener.style.width="",contener.style.visibility="visible",isAvatar?(headerMSG.classList.remove("withoutAvatar"),headerMSG.classList.add("withAvatar")):(headerMSG.classList.remove("withAvatar"),headerMSG.classList.add("withoutAvatar")),countNewMessages.setAttribute("class","czater-disable"),contener.setAttribute("data-display","on"),contener.style.overflow=set_minimized_button?"hidden":"",set_minimized_button&&"off"===contener.getAttribute("data-display")?contener.style.width="41px":(0==newLayout&&(contener.style.width="350px"),2==newLayout?contener.style.width="380px":3==newLayout?contener.style.width="350px":isMobile.any()?contener.style.width="":contener.style.width="340px"),e&&(headerClass="czater-header czater-header-normal",2!=newLayout&&(isMobile.any()||1===avatar_position||-1<window.location.href.indexOf("getChatWindowed"))&&(headerClass+=" avatarInside"),header.setAttribute("class",headerClass),chosenSection?(headerMSG.innerHTML=header_consultant,""!==avatar_online?(avatar.innerHTML!=avatar_online&&(avatar.innerHTML=avatar_online),headerMSG.classList.remove("withoutAvatar"),headerMSG.classList.add("withAvatar")):(headerMSG.classList.remove("withAvatar"),headerMSG.classList.add("withoutAvatar"),isAvatar=!1,avatar.innerHTML="")):"1"==contener.getAttribute("conversation-ongoing")?headerMSG.innerHTML=header_consultant:(headerMSG.innerHTML=header_online,isAvatar=!1,avatar.innerHTML="")),classAttr="contener-lower",(0===rounded_corners||-1<window.location.href.indexOf("getChatWindowed"))&&(classAttr+=" nonRadius"),1===(chat_position=set_chat_position?parseInt(set_chat_position):chat_position)&&(classAttr+=" attachment-bottom-right"),2===chat_position?classAttr+=" attachment-bottom-left":3===chat_position?classAttr+=" attachment-right-edge":4===chat_position&&(classAttr+=" attachment-left-edge"),0===(chat_mobile_position=set_chat_mobile_position?parseInt(set_chat_mobile_position):chat_mobile_position)?classAttr+=" invisible-chat":1===chat_mobile_position?classAttr+=" attachment-mobile-bottom-right":2===chat_mobile_position?classAttr+=" attachment-mobile-bottom-left":3===chat_mobile_position?classAttr+=" attachment-mobile-right-edge":4===chat_mobile_position&&(classAttr+=" attachment-mobile-left-edge"),contener.setAttribute("class",classAttr),iframeNewMessage.style.display="block"},t?showChatInside():setTimeout(function(){showChatInside()},300)},function(){windowed&&windowed.click()}),setPatron=function(e){e&&(patron=e)},refreshClient=function(t){return"object"==typeof t&&new Promise(e=>{socket.emit("refreshWidgetClient",t,window.$czater.tok,e)})},openChatDecider=($czaterMethods.showChat=showChat,$czaterMethods.showChatWindowed=showChatWindowed,$czaterMethods.toggleCallBanner=toggleCallBanner,$czaterMethods.setPatron=setPatron,$czaterMethods.refreshClient=refreshClient,$czaterMethods.toggleVideoCallBanner=function(){console.log("Video call not ready yet")},hideChat=function(e,t){t=void 0!==t&&t,"on"===contener.getAttribute("data-display")&&(contener.setAttribute("data-anim","off"),czaterEvents.sendEvent("hideChat"),czaterSR.sendCustomRequest(1,"czater_closed-chat-window",{}),allowMobileBack)&&isMobile.any()&&history&&history.replaceState&&history.replaceState(null,""," "),hideChatInside=function(){contener.removeAttribute("data-anim"),contener.setAttribute("data-anim","on"),void 0===e&&(e=!1),set_windowed||(e||createCookie(cookie_prefix+cookie_open,"0",1),contener.removeAttribute("class","contener-lower"),contener.setAttribute("data-display","off"),headerClass="czater-header czater-button",(isMobile.any()||1===avatar_position||-1<window.location.href.indexOf("getChatWindowed"))&&(headerClass+=" avatarInside"),previousStatusData.avatar&&(isAvatar=!0,1.5<window.devicePixelRatio?avatar.innerHTML=previousStatusData.avatar.big:avatar.innerHTML=previousStatusData.avatar.small),headerClass+=" czater-height",header.setAttribute("class",headerClass),classAttr="",(0===rounded_corners||-1<window.location.href.indexOf("getChatWindowed"))&&(classAttr+=" nonRadius"),1===(chat_position=set_chat_position?parseInt(set_chat_position):chat_position)&&(classAttr+=" attachment-bottom-right"),2===chat_position?classAttr+=" attachment-bottom-left":3===chat_position?classAttr+=" attachment-right-edge":4===chat_position&&(classAttr+=" attachment-left-edge"),0===(chat_mobile_position=set_chat_mobile_position?parseInt(set_chat_mobile_position):chat_mobile_position)?classAttr+=" invisible-chat":1===chat_mobile_position?classAttr+=" attachment-mobile-bottom-right":2===chat_mobile_position?classAttr+=" attachment-mobile-bottom-left":3===chat_mobile_position?classAttr+=" attachment-mobile-right-edge":4===chat_mobile_position&&(classAttr+=" attachment-mobile-left-edge"),contener.setAttribute("class",classAttr),void 0!==button_online&&(headerMSG.innerHTML=button_online),contener.style.overflow=set_minimized_button?"hidden":"",set_minimized_button&&"off"===contener.getAttribute("data-display")?contener.style.width="41px":contener.style.width="",contener.style.height="30px",contener.style.visibility="visible",updateUnreadMessages("show"))},t?hideChatInside():setTimeout(function(){hideChatInside()},300)},$czaterMethods.hideChat=hideChat,function(e){e=void 0===e||e;var t="stay";return"auto"===chatOpenMode?t=noViewPort&&window.screen.width<770||isMobile.iPad()||isMobile.iPhone()?(window.event&&windowed.click(),"windowed"):(e&&showChat(!0),"stay"):"windowed"===chatOpenMode?(window.event&&windowed.click(),t="windowed"):"stay"===chatOpenMode&&(e&&showChat(!0),t="stay"),t}),getTemplate=function(t,a){if(t.template.css.forEach(function(e){(e.name===set_css_template||e.referer&&checkReferer(referer,e.referer))&&(e.auto=1)}),t.template.widgets=currentWidget,templateData=t,!templateLoaded){var e=document.createElement("div"),n=(e.innerHTML=t.template.content,body.appendChild(e.firstChild),timestamp=t.template.timestamp,static_url=t.staticUrl+timestamp+"/",srcRecorder=static_url+srcRecorder,srcCall=static_url+srcCall,updateTemplate(t),!1);on(document.getElementById("welcome_text"),"click",function(){a.emit("ToServerChatChange",{chatOpen:!0,chatHash:chatHash,consultantID:window.$czater.tok}),openChatDecider(),n=!1}),on(document.getElementById("chatHeader"),"click",function(){"1"===readCookie(cookie_prefix+cookie_open)||n||(a.emit("ToServerChatChange",{chatOpen:!0,chatHash:chatHash,consultantID:window.$czater.tok}),openChatDecider()),n=!1}),on(document.getElementById("teaser_caption"),"click",function(){a.emit("ToServerChatChange",{chatOpen:!0,chatHash:chatHash,consultantID:window.$czater.tok}),openChatDecider(),n=!1}),on(document.getElementById("minimize"),"click",function(){n=!0,open&&slideToggle(),a.emit("ToServerChatChange",{chatOpen:!1,chatHash:chatHash,consultantID:window.$czater.tok}),hideChat()}),on(document.getElementById("windowed"),"click",function(){n=!0,hideChat(),e=-1<document.getElementById("czater-iframe").src.indexOf("getEmailForm")?document.getElementById("czater-iframe").src:(e="?login="+client_name+"&email="+client_email+"&"+(!1!==userSection?"section="+userSection+"&":"")+(additionParams?"addition_params="+JSON.stringify(additionParams)+"&":"")+(set_css_template?"css_template="+set_css_template+"&":""),base_url+"chat/getChatWindowed/"+tempHash+"/"+window.$czater.tok+"/"+language+e);var e,t=300,a=400;0==newLayout?(t=320,a=480):2==newLayout?(t=390,a=600):3==newLayout&&(t=350,a=600),window.open(e+"windowed","_blank","titlebar=0,toolbar=0,location=0,directories=0,menubar=0,status=0,resizable=0,width="+t+",height="+a)}),on(document.getElementById("closeConversation"),"click",function(){0===messagesCount||0===convInProgress?(n=!0,a.emit("ToServerChatChange",{chatOpen:!1,chatHash:chatHash,consultantID:window.$czater.tok}),hideChat(),-1<window.location.href.indexOf("getChatWindowed")&&(createCookie(cookie_prefix+cookie_open,"0",1),window.close())):slideToggle()}),on(document.getElementById("closeConversationMenu"),"click",doCloseConversation),on(document.getElementById("czaterReturn"),"click",function(){chosenSection=null,document.getElementById("czaterReturn").style.display="none",postMessage("czaterReturn",{}),newGetStatus()}),on(document.getElementById("chatHeader"),"click",function(){var e=document.createElement("input");e.setAttribute("type","checkbox"),document.getElementById("czater-contener").appendChild(e),e.focus(),document.getElementById("czater-contener").removeChild(e)}),document.addEventListener("click",function(e){("switch-conv-from-bot"==e.target.id||e.target.parentNode&&"switch-conv-from-bot"==e.target.parentNode.id)&&(a.emit("ToServerClientSwitchFromBot",{adminHash:window.$czater.tok,chatHash:chatHash,clientLanguage:language}),e=document.getElementById("switch-conv-from-bot"),convInProgress=0,e.parentNode.removeChild(e))}),recorder&&recorder.playback?document.getElementById("czater-iframe").src=base_url+"iframe/index":document.getElementById("czater-iframe").src=t.url;try{var o=new CustomEvent("frameLoaded",{detail:{status:t.status,chatHash:chatHash}});window.dispatchEvent(o)}catch(e){try{(o=document.createEvent("Event")).initEvent("frameLoaded",!0,!0),o.detail={status:t.status,chatHash:chatHash},window.dispatchEvent(o)}catch(e){}}a.emit("ToServerGetSettings",{userHash:window.$czater.tok,chatHash:chatHash,language:language,host:window.location.href,base_url:base_url,patron:patron,idWidget:currentWidget.idWidget}),templateLoaded=!0}},src=base_url+"assets/modules/chat/js/socket.io.js?v=11",main=function(){var e,o,a;function n(){!1===liveInterval&&o&&(liveInterval=setInterval(function(){var e;socket.connected&&recorder&&recorder.events&&0<(e=recorder.events.length-liveFrame)&&(e=recorder.compress(JSON.stringify(recorder.events.slice(-1*e))),socket.emit("toServerUserLivePreview",{chatHash:chatHash,items:e,consultantHash:window.$czater.tok}),liveFrame=recorder.events.length)},40))}function i(){var e=new Date,t=date2str(e,"yyyy-MM-dd hh:mm:ss");recorder?n():loadScript(srcRecorder,function(){recorder=new EventRecorder({recorder:!0,startDate:t});window.location.href;n()})}function t(){var e,t;a||(a=!0,(e=document.createElement("link")).setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",static_url+"assets/css/mymouse.css"),all.insertBefore(e,all.childNodes[0]),e=document.createElement("div"),t=document.createElement("div"),e.appendChild(t),e.id="mymouse",document.body.appendChild(e))}mainLoaded||"undefined"==typeof io270365||(mainLoaded=!0,register_tab_GUID(),e=document.getElementsByTagName("body"),body=0<e.length?e[0]:document.documentElement,e=document.getElementsByTagName("head"),head=0<e.length?e[0]:document.documentElement,checkChatBlock())||(e={reconnectionDelay:5e3,reconnectionDelayMax:3e4,perMessageDeflate:!1},WebSocket&&(e.transports=["websocket"],e.upgrade=!1),"object"!=typeof socket&&(socket=-1<base_url.indexOf("czaterdev.pl")&&-1<base_url.indexOf("https")?io270365.connect("https://s1.czaterdev.pl",e):-1<base_url.indexOf("czaterdev.pl")?io270365.connect("http://localhost:3001/",e):!(-1<base_url.indexOf("chater.pl"))&&socket_path?io270365.connect(socket_url,{path:socket_path}):io270365.connect(socket_url,e),Rf2jK5f=socket),client_email&&null!=client_email&&void 0!==client_email&&"undefined"!==client_email||(client_email=""),""===(client_name=client_name&&null!=client_name&&void 0!==client_name&&"undefined"!==client_name?client_name:"")&&document.getElementsByClassName("hello")[0]&&"B"===document.getElementsByClassName("hello")[0].lastElementChild.nodeName&&(userLogin=document.getElementsByClassName("hello")[0].lastElementChild.textContent,client_name=document.getElementsByClassName("hello")[0].lastElementChild.textContent),canGetUserStatus=!0,socket.on("disconnect",function(e){socketConnected=!1}),socket.on("connect",function(e){var t;firstEnter&&(socketConnected=!(firstEnter=!1),setTimeout(function(){var e=document.createElement("iframe");e.src=base_url+"themes/new_userpanel/chat/a.html?"+window.$czater.tok,e.style.display="none",e.id="preloadIframe",document.body.appendChild(e)},1),triesInterval=setInterval(function(){chatLoaded||(checkChatBlock()?(socket.disconnect(),destroy()):maxTries<=tries||(++tries,chatLoaded)||(mainLoaded=!1,destroy(),main()))},6e4),testInterval=setInterval(function(){socket.emit("ToServerTest",{test:1})},3e5),(new Date).getTime(),t=!0,internetInterval=setInterval(function(){var e;socket.connected?(postMessage("internet",{internet:!0,chosenSection:chosenSection}),!socketConnected&&t&&(e=(new Date).getTime(),t=!(socketConnected=!0),null!==document.getElementById("e3D18r_czater"))&&"none"!==document.getElementById("e3D18r_czater").style.display&&null!==document.getElementById("czater-contener")&&"on"===document.getElementById("czater-contener").getAttribute("data-display")&&(t=!0,refreshPage())):(postMessage("internet",{internet:!1}),socketConnected=!1)},1e4),currentUrlInterval=setInterval(function(){var e,t,a;referer!==document.URL&&-1==document.URL.indexOf("getChatWindowed")&&(referer=document.URL,!1===userSection&&postMessage("refererSetter",referer),"undefined"!=typeof czatercall&&czatercall&&czatercall.send("banner","sections",{referer:referer}),recorder&&(t=new Date,e=date2str(t,"yyyy-MM-dd hh:mm:ss"),allowSend=!0,recorder.start=t.getTime(),t=document.URL,a=recorder.compress(recorder.html),socket.emit("toServerStartRecording",{width:recorder.width,height:recorder.height,dateBegin:e,frameURL:t,chatHash:chatHash,consultantHash:window.$czater.tok,html:a})),tryNewUserData(),ToServerCheckStatus())},300),connectionsInterval=setInterval(function(){maxTries<=tries&&(tries=0)},3e5))}),o=!1,socket.on("newGetStatus",function(){newGetStatus()}),socket.on("giveTrialTime",function(e){postMessage("giveTrialTime",e)}),socket.on("changeChosenSection",function(e){postMessage("changeChosenSectionMsg",{chosenSection:chosenSection=e.idSection})}),socket.on("switchToOffline",function(){postMessage("switchToOffline",{})}),socket.on("toClientStopLive",function(e){recorder=o=!1,clearInterval(liveInterval),liveInterval=!1;var t=document.getElementById("mymouse");null!=t&&t.parentNode.removeChild(t)}),socket.on("toClientStartLive",function(e){var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=document.documentElement.outerHTML;socket.emit("toServerStartLive",{w:t,h:a,html:n,client:e.client,admin:window.$czater.tok,url:window.location.href}),o=!0,i()}),socket.on("toClientPingUrl",function(e){var t,a;e.url!==window.location.href?(t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,socket.emit("toServerChangeURL",{w:t,h:a,url:window.location.href,html:document.documentElement.outerHTML,client:e.client,admin:window.$czater.tok,data:e.url})):i()}),socket.on("ToClientEnableCzatercall",function(a){var e=myCache.getCache(myCache.constants.callLangs);!a.lang&&e?a.lang=e:(a.lang=a.lang,myCache.setCache(myCache.constants.callLangs,a.lang)),myCache.setCache(myCache.constants.callCountries,a.countries),0==a.isOnline&&0===a.callbackOfflineLeads||window.location.href.indexOf("userPanel")<0&&loadScript(srcCall,function(){var e,t=isMobile.any()?chat_mobile_position:chat_position;null!=czatercall_teaser&&(isMobile.any(),t="1"==t||"3"==t?"left":"right",e=chatInvitationPosition?"position-on-top":"position-on-side",chatInvitationPosition&&""==czatercall_teaser_button.innerHTML&&(czatercall_teaser_button.style.display="none"),czatercall_teaser.classList.add("czatercall-"+t),czatercall_teaser.classList.add(e)),czatercall.init({baseURL:base_url,staticURL:static_url,referer:referer,hash:window.$czater.tok,layout:newLayout,position:chat_position,positionMobile:chat_mobile_position,screenWidth:window.innerWidth,mobile:!!isMobile.any(),urls:urls,settings:a,client:{name:client_name,email:client_email},clientDataAsk:a.clientDataAsk,clientCustomFields:clientCustomFields,markCall:a.markCall,forceCallback:forceCallback,externalCSS:externalCSS,widget:currentWidget}),socket.on("czatercallMessages",function(e){czatercall.listenerSocket(e)})})}),socket.on("CallbackAvailability",function(e){czatercall.send("banner","availability",e)}),socket.on("callbackCheckCode",function(e){czatercall.send("banner","codeVerification",e)}),socket.on("phoneVerified",function(e){czatercall.send("banner","phoneVerified",e)}),socket.on("checkSectionsPayment",function(){czatercall.send("banner","checkSectionsPayment")}),socket.on("callbackSectionChanged",function(e){czaterEvents.sendEvent("callbackSectionChanged",{idSection:e})}),socket.on("ToClientRecordUser",function(e){var a;e.record&&(e=new Date,a=date2str(e,"yyyy-MM-dd hh:mm:ss"),loadScript(srcRecorder,function(){allowSend=!0,recorder=new EventRecorder({recorder:!0,startDate:a});var e=window.location.href,t=recorder.compress(recorder.html);!1===recordingInterval&&(recordingInterval=setInterval(function(){var e;socket.connected&&isRecording&&recorder&&recorder.events&&allowSend&&recId&&100<recorder.events.length-1-frameNumber&&(e=recorder.compress(JSON.stringify(recorder.events.slice(frameNumber))),socket.emit("toServerUserRecordingPart",{recId:recId,chatHash:chatHash,items:e,consultantHash:window.$czater.tok}),frameNumber=recorder.events.length)},100)),socket.emit("toServerStartRecording",{width:recorder.width,height:recorder.height,dateBegin:a,frameURL:e,chatHash:chatHash,consultantHash:window.$czater.tok,html:t})}))}),a=!1,socket.on("toClientClick",function(e){t(),document.getElementById("mymouse").style.left=e.x+"px",document.getElementById("mymouse").style.top=e.y+"px",document.getElementById("mymouse").classList.add("click"),setTimeout(function(){document.getElementById("mymouse").classList.remove("click")},500)}),socket.on("toClientMove",function(e){t(),document.getElementById("mymouse").style.left=e.x+"px",document.getElementById("mymouse").style.top=e.y+"px"}),socket.on("toClientScroll",function(e){var t=window.pageYOffset||document.documentElement.scrollTop,e=((t+=e.y)<0&&(t=0),document.body),a=document.documentElement,e=Math.max(e.scrollHeight,e.offsetHeight,a.clientHeight,a.scrollHeight,a.offsetHeight);e<t&&(t=e),window.scrollTo(0,t)}),socket.on("ToClientRecord",function(e){recId=e.id}),socket.on("ToClientStartNewRecord",function(e){var t=window.location.href,a=new Date,n=date2str(a,"yyyy-MM-dd hh:mm:ss");allowSend=!0,recorder?(recorder.start=a.getTime(),a=recorder.compress(recorder.html),socket.emit("toServerStartRecording",{width:recorder.width,height:recorder.height,dateBegin:n,frameURL:t,chatHash:chatHash,consultantHash:window.$czater.tok,html:a})):loadScript(srcRecorder,function(){var e=(recorder=new EventRecorder({recorder:!0,startDate:n})).compress(recorder.html);socket.emit("toServerStartRecording",{width:recorder.width,height:recorder.height,dateBegin:n,frameURL:t,chatHash:chatHash,consultantHash:window.$czater.tok,html:e})})}),socket.on("queueClientHash",function(e){var t=(new Date).getTime(),t=new Date(t+31536e6),a=e.adminHash,n=e.newClientHash;document.cookie="czater__="+n+"; expires="+t.toUTCString()+"; path=/;",document.cookie="czater__"+a+"="+n+"; expires="+t.toUTCString()+"; path=/;",createCookie(cookie_prefix+cookie_name+window.$czater.tok,n,365),postMessage("queueClientHash",e)}),socket.on("toClientChatIsFree",()=>{var e=(new Date).getTime();e+=864e5,e3D18r_czater.localStorage.setItem("czater_chatBlockedTo_"+window.location.host,e),socket.disconnect()}),socket.on("userStatus",function(e){var t=e.lang,t=(myCache.getCache(myCache.constants.language).language!==t&&myCache.clearCaches(),e.timestamp&&e.refreshClientCache&&myCache.setNewCacheTimestamp(e.timestamp),{language:t});if(myCache.setCache(myCache.constants.language,t),chatbotsForms=e.chatbotsForms,e.customFields){const n=window.location.href;t=e.customFields.filter(e=>{if(void 0!==e.domain&&null!==e.domain&&""!==e.domain){let t=!1;if(e.domain.split("|").map(e=>{n.includes(e)&&(t=!0)}),!t)return!1}return!0});clientCustomFields=t}if(e.adminHash===window.$czater.tok){e.ip&&(ip=e.ip);var t=myCache.getCache(myCache.constants.exclusionsDesktop),a=myCache.getCache(myCache.constants.exclusionsMobile);if(t&&a?(e.exclusionsDesktop=t,e.exclusionsMobile=a):e.exclusionsDesktop&&e.exclusionsMobile&&(myCache.setCache(myCache.constants.exclusionsDesktop,e.exclusionsDesktop),myCache.setCache(myCache.constants.exclusionsMobile,e.exclusionsMobile)),excluded=isExcluded(e),checkExcluded(),e.client.name&&(client_name=e.client.name),e.client.email&&(client_email=e.client.email),firstRefererSent||runTriggers(),canGetUserStatus){let a=canGetUserStatus=!1,n=e.widgets[0];const o=window.$czater.idWidget,i=window.location.href;0<e.widgets.length&&(e.widgets=e.widgets.map(e=>{let t=!1;return a||(o&&o==e.idWidget?t=!0:o||(0<=e.domain.indexOf(",")?e.domain.split("|").map(e=>{0<=i.indexOf(e.trim())&&(t=!0)}):0<=i.indexOf(e.domain.trim())&&(t=!0)),t&&(e.selected=!0,a=!0,n=e)),e})),currentWidget=n;t="";chatHash=chatHash||e.chatHash,window.$czater.chatHash=chatHash,createCookie(cookie_prefix+cookie_name+window.$czater.tok,chatHash,365),t=base_url+"chat/getClientChat/"+chatHash+"/"+window.$czater.tok+"/"+language+"/"+currentWidget.idWidget+"?",set_windowed&&(t+="windowed=1&"),set_css_template&&(t+="css_template="+set_css_template+"&"),canGetTemplate=!0,myCache.getCache(myCache.constants.template);socket.emit("ToServerGetTemplate",{token:window.$czater.tok,chatHash:chatHash,base:base_url,url:t,language:language,user:e.user,css_template:set_css_template,idWidget:currentWidget.idWidget}),0<e.unreadMessagesCount&&(unreadMessagesCount=e.unreadMessagesCount)}}}),socket.on("gettemplate",function(e){myCache.setCache(myCache.constants.template,e),canGetTemplate&&(chatLoaded=!(canGetTemplate=!1),getTemplate(e,socket))}),socket.on("EndConversation",function(e){newGetStatus(),e.adminHash===window.$czater.tok&&(setConversasionOngoing(!1),convInProgress=0,czaterEvents.sendEvent("conversationEnd",{idConversation:e.idConversation}),postMessage("EndConversation",e),updateUnreadMessages("reset"),e.clientHash=chatHash,"object"==typeof SR)&&"object"==typeof SyneriseTC&&(socket.emit("getConvMsgsForSynerise",e,function(e){e&&czaterSR.sendCustomRequest(1,"czater_ended-chat-conv",{messages:JSON.stringify(e)})}),checkInputBlockade())}),socket.on("ShowClientData",function(e){e.adminHash===window.$czater.tok&&postMessage("ShowClientData",e)}),socket.on("message",function(e){e.adminHash===window.$czater.tok&&(0==messagesCount&&czaterEvents.sendEvent("firstMessage",{name:client_name,email:client_email,idConversation:e.convId}),"function"==typeof document.hasFocus&&!document.hasFocus()&&e.rows&&e.rows[0]&&"consultant"===e.rows[0].whoWrote&&showTitle&&setTimeout(function(){startTitleInterval()},300),e&&e.rows[0]&&"consultant"===e.rows[0].whoWrote&&updateUnreadMessages("add"),messagesCount++,e.showChat&&showChat(!0),convInProgress=1,simpleStatus=0,e3D18r_czater.localStorage.setItem("simpleStatus",0),createCookie(cookie_prefix+cookie_last_section,chosenSection,30),postMessage("message",e))}),socket.on("allowConversation",function(e){e.adminHash===window.$czater.tok&&postMessage("allowConversation",e)}),socket.on("refreshAllUsers",function(e){window.location.reload(!0)}),socket.on("disallowConversation",function(e){e.adminHash===window.$czater.tok&&postMessage("disallowConversation",e)}),socket.on("ConsultantWriting",function(e){e.adminHash==window.$czater.tok&&postMessage("ConsultantWriting",e)}),socket.on("getUserData",function(e){e.adminHash===window.$czater.tok&&(client_name=e.name,client_email=e.email,userLogin&&""!==userLogin.trim()&&(client_name=userLogin),postMessage("getUserData",{email:client_email=userEmail&&""!==userEmail.trim()?userEmail:client_email,name:client_name}))}),socket.on("ConsultantBeginConversation",function(e){anotherTab||socket.emit("ToServerChatChange",{chatOpen:!0,chatHash:chatHash,consultantID:window.$czater.tok}),e.adminHash===window.$czater.tok&&(showChat(!0),newGetStatus(),postMessage("ConsultantBeginConversation",1))}),socket.on("ClientBeginConversation",function(e){}),socket.on("ClientGetSection",function(e){e.adminHash===window.$czater.tok&&("offline"===e.status.status&&0==e.status.always?header_offline=e.status.header:header_online=e.status.header,avatar_online=e.status.avatar?1.5<window.devicePixelRatio?e.status.avatar.big:e.status.avatar.small:"",e.status.header&&"on"===contener.getAttribute("data-display")&&(headerMSG.innerHTML=e.status.header),e.status.avatar?(1.5<window.devicePixelRatio?avatar.innerHTML=e.status.avatar.big:avatar.innerHTML=e.status.avatar.small,headerMSG.classList.remove("withoutAvatar"),headerMSG.classList.add("withAvatar"),avatar.style.display="block"):(avatar.innerHTML="",headerMSG.classList.remove("withAvatar"),headerMSG.classList.add("withoutAvatar")))}),socket.on("getSettingsToClient",function(e){var t;e.settings.lastSectionAuto&&(t=readCookie(cookie_prefix+cookie_last_section))&&!e.settings.ignoredLastSections.includes(t)&&(userSection=t),allTriggers=e.settings.triggers,showTitle=e.settings.showTitle,updateSettings(e.settings)}),socket.on("getStatusToClient",function(t){ifKruk=t.status.kruk,tryNewUserData(),setWindowUrlVar(status.status),t.status.timeLeft&&postMessage("timeLeftFromStatus",{timeLeft:t.status.timeLeft}),postMessage("templateLoaded",null===chosenSection?{status:t.status,convInProgress:convInProgress,userSection:userSection}:{status:t.status,convInProgress:convInProgress,onlyCreate:!0,userSection:userSection});var e={};for(const o in t.status.sectionsOffline)e[o]={},e[o].sectionStatus="offline",e[o].consultantStatus=t.status.sectionsOffline[o].status;for(const i in t.status.sectionsOnline)e[i]={},e[i].sectionStatus="online",e[i].consultantStatus=t.status.sectionsOnline[i].status;sectionsStatus=e,welcomeMsg=t.status.welcome,welcome_offlineMsg=t.status.welcome_offline,convInProgress=t.status.convInProgress,changeFirstMessage(),getStatus(t.status);var a=(new Date).getTime(),n=(setConversasionOngoing(t.status.convInProgress),unreadMessagesCount=t.status.convInProgress?unreadMessagesCount:0,updateUnreadMessages("show"),function(){setTimeout(function(){var e=3e4<(new Date).getTime()-a;(!t.status.kruk||e||null!==chosenSection)&&0!=cssLoaded&&("true"==cssLoaded.getAttribute("data-e3d18r-css-loaded")||e)&&!1===firstSettingsSent?(checkExcluded(),contener.style.display="block",randomizeTime=!0):n()},100)});n(),isBot=t.status.isBot,receivedByConsultant=t.status.receivedByConsultant,checkInputBlockade()}),socket.on("getInvolvingActionsToClient",function(e){startInvolvingAction(e)}),socket.on("GetLocation",function(e){for(var t in e)if(e[t][0]&&""!==e[t][0].trim()){t=e[t][0].toLowerCase();czatercall.send("banner","localisation",t);break}}),socket.on("surveyTemplate",function(e){e.adminHash===window.$czater.tok&&("call"==e.originType&&"undefined"!=typeof czatercall?czatercall.send("banner","survey",e):postMessage("surveyTemplate",e))}),socket.on("UpdateMessage",function(e){postMessage("UpdateMessage",e)}),socket.on("readMessagesByConsultantDone",function(e){postMessage("readMessagesByConsultantDone",e)}),socket.on("setCallStatus",function(e){e.adminHash===window.$czater.tok&&czatercall.setStatus("online"===e.status?"online":"offline",e.schedule,e.availability)}))},destroy=function(){firstAnimationCall=canGetUserStatus=canGetTemplate=absolutelyFirst=!(firstSettingsSent=!(firstEnter=!(templateLoaded=chatLoaded=mainLoaded=!1))),firstCookie=!(y3Qc6aR=void 0),null!==all&&null!=all.parentNode&&(all.parentNode.removeChild(all),all=null),null!==triesInterval&&(clearInterval(triesInterval),triesInterval=null),null!==testInterval&&(clearInterval(testInterval),testInterval=null),null!==internetInterval&&(clearInterval(internetInterval),internetInterval=null),null!==connectionsInterval&&(clearInterval(connectionsInterval),connectionsInterval=null),null!==currentUrlInterval&&(clearInterval(currentUrlInterval),currentUrlInterval=null),socket&&socket.disconnect(),socket=!1},isMobile=($czaterMethods.destroy=destroy,$czaterMethods.getStatus=function(){return userStatus},{Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPod/i)},iPad:function(){return navigator.userAgent.match(/iPad/i)},iPhone:function(){return navigator.userAgent.match(/iPhone/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile|Lumia/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()||isMobile.iPad()}});notAutoCreate||("complete"===document.readyState?loadScript(src,main):window.attachEvent?window.attachEvent("onload",function(){loadScript(src,main)}):(body=document.getElementsByTagName("body")[0],interval=setInterval(function(){"complete"===document.readyState&&(clearInterval(interval),loadScript(src,main))},10)));try{cookie&&(chatHash=cookie,window.$czater.chatHash=chatHash,client_name=name,client_email=email,referer=-1===httpRef.indexOf("getChatWindowed")?(createCookie(cookie_prefix+cookie_lastReferer,httpRef,CookieTTL),httpRef):null!==readCookie(cookie_prefix+cookie_lastReferer)?readCookie(cookie_prefix+cookie_lastReferer):window.location.href,postMessage("getUserData",{email:client_email,name:client_name}))}catch(err){chatHash=readCookie(cookie_prefix+cookie_name+window.$czater.tok),chatHash=chatHash||readCookie(cookie_prefix+cookie_name),window.$czater.chatHash=chatHash}var frameNumber=0,liveFrame=0,czaterEvents={lagnuagePolish:{triggerWelcome:{eventCategory:"Czater",eventAction:"Akcje automatyczne",eventLabel:"Zaproszenie do rozmowy",eventValue:0},triggerPopup:{eventCategory:"Czater",eventAction:"Akcje automatyczne",eventLabel:"Wyświetl komunikat",eventValue:0},triggerUserInvolving:{eventCategory:"Czater",eventAction:"Akcje automatyczne",eventLabel:"Angażowanie klienta",eventValue:0},triggerCallbackInvitation:{eventCategory:"Czater",eventAction:"Akcje automatyczne",eventLabel:"Rozmowa telefoniczna",eventValue:0},callRequest:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Nowa rozmowa telefoniczna",eventValue:0},callRequestLater:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Rozmowa telefoniczna na później",eventValue:0},callbackReady:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Widget callbacku gotowy",eventValue:0},callbackSectionChanged:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Zmiana działu telefonu",eventValue:0},chatSectionChanged:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Zmiana działu czatu",eventValue:0},firstMessage:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Pierwsza wiadomość",eventValue:0},conversationEnd:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Koniec rozmowy",eventValue:0},messageOffline:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Wiadomość offline",eventValue:0},dataAsk:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Zapytanie o dane",eventValue:0},dataSave:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Zapisanie danych",eventValue:0},showChat:{eventCategory:"Czater",eventAction:"Kliknięcie",eventLabel:"Pokaż okno czatu",eventValue:0},hideChat:{eventCategory:"Czater",eventAction:"Kliknięcie",eventLabel:"Schowaj okno czatu",eventValue:0},showCallBanner:{eventCategory:"Czater",eventAction:"Kliknięcie",eventLabel:"Pokaż okno telefonu",eventValue:0},hideCallBanner:{eventCategory:"Czater",eventAction:"Kliknięcie",eventLabel:"Schowaj okno telefonu",eventValue:0}},languageEnglish:{triggerWelcome:{eventCategory:"Chater",eventAction:"Automation",eventLabel:"Invitation to conversation",eventValue:0},triggerPopup:{eventCategory:"Chater",eventAction:"Automation",eventLabel:"Show popup",eventValue:0},triggerUserInvolving:{eventCategory:"Chater",eventAction:"Automation",eventLabel:"Client involving actions",eventValue:0},triggerCallbackInvitation:{eventCategory:"Chater",eventAction:"Automation",eventLabel:"Phone call",eventValue:0},callRequest:{eventCategory:"Chater",eventAction:"Callback",eventLabel:"New phone request",eventValue:0},callRequestLater:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Phone request for later",eventValue:0},callbackReady:{eventCategory:"Chater",eventAction:"Callback",eventLabel:"Callback widget ready",eventValue:0},callbackSectionChanged:{eventCategory:"Chater",eventAction:"Callback",eventLabel:"Callback section change",eventValue:0},chatSectionChanged:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Chat section change",eventValue:0},firstMessage:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"First message",eventValue:0},conversationEnd:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Conversation end",eventValue:0},messageOffline:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Offline message",eventValue:0},dataAsk:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Ask for data",eventValue:0},dataSave:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Save client data",eventValue:0},showChat:{eventCategory:"Chater",eventAction:"Click",eventLabel:"Show chat window",eventValue:0},hideChat:{eventCategory:"Chater",eventAction:"Click",eventLabel:"Hide chat window",eventValue:0},showCallBanner:{eventCategory:"Chater",eventAction:"Click",eventLabel:"Show phone window",eventValue:0},hideCallBanner:{eventCategory:"Chater",eventAction:"Click",eventLabel:"Hide phone window",eventValue:0}},setEnabled:function(e){czaterEvents.enabled=!!e},checkIfEnabled:function(){return czaterEvents.enabled},sendEvent:function(e,t){var a,t=t?t:{};"object"==typeof e&&e.value&&(t=e.value),"object"==typeof e&&e.category&&(e=e.category),czaterEvents.callJSHook(e,t),"chatReady"!==e&&"callbackReady"!==e&&"videoCallReady"!==e&&"callbackSectionChanged"!==e&&"chatSectionChanged"!==e&&(a={},"showCallBanner"===e?socket.emit("toServerClientEvent",{event:"SHOW_CALL"}):"hideCallBanner"===e?socket.emit("toServerClientEvent",{event:"HIDE_CALL"}):"callRequest"!==e&&"callRequestLater"!==e||"true"!=e3D18r_czater.sessionStorage.getItem("czatercallTrigger")?"firstMessage"===e&&"true"==e3D18r_czater.sessionStorage.getItem("czatPopupTrigger")&&(e3D18r_czater.sessionStorage.removeItem("czatPopupTrigger"),socket.emit("toServerClientEvent",{event:"CONVERSATION_START_FROM_TRIGGER"})):(e3D18r_czater.sessionStorage.removeItem("czatercallTrigger"),socket.emit("toServerClientEvent",{event:"PHONECALL_START_FROM_TRIGGER"})),e=(a=("https://www.chaterbiz.com/"===base_url||"https://www.chater.biz/"===base_url||"https://www.chater.app/"===base_url?czaterEvents.languageEnglish:czaterEvents.lagnuagePolish)[e]).eventValue,t.idConversation&&(e=t.idConversation),czaterEvents.checkIfEnabled())&&czaterEvents.sendCustomEvent(a.eventCategory,a.eventAction,a.eventLabel,e)},callJSHook:function(e,t){e="on"+e.charAt(0).toUpperCase()+e.slice(1);"object"==typeof $czaterEvents&&"function"==typeof $czaterEvents[e]&&$czaterEvents[e](t)},sendCustomEvent:function(e,t,a,n){"undefined"!=typeof gtag?czaterEvents.gtagEvent(e,t,a,n):"undefined"!=typeof ga?czaterEvents.analyticsEvent(e,t,a,n):"undefined"!=typeof _gaq&&czaterEvents.gaEvent(e,t,a,n),"undefined"!=typeof dataLayer&&czaterEvents.dataLayerEvent(e,t,a,n)},analyticsEvent:function(e,t,a,n){var o;return!!e&&!!t&&((o={hitType:"event"}).eventCategory=e,o.eventAction=t,a&&(o.eventLabel=a),n&&(o.eventValue=n),void ga("send",o))},gaEvent:function(e,t,a,n){var o;return!!e&&!!t&&((o={}).eventCategory=e,o.eventAction=t,o.eventLabel="",o.eventValue=0,a&&(o.eventLabel=a),n&&(o.eventValue=n),void _gaq.push(["_trackEvent",o.eventCategory,o.eventAction,o.eventLabel,o.eventValue]))},gtagEvent:function(e,t,a,n){return!!e&&!!t&&(0,a&&0,n&&0,void gtag("event","Czater",{event_category:e,event_action:t,event_label:a,value:n}))},dataLayerEvent:function(e,t,a,n){var o;return!!e&&!!t&&((o={event:"CzaterEvent"}).eventCategory=e,o.eventAction=t,o.eventLabel=a||"",o.eventValue=n||"",void("object"==typeof dataLayer&&"function"==typeof dataLayer.push&&dataLayer.push(o)))}},czaterSR={sendCustomRequest:function(e,t,a){ifKruk&&(1==e?this.sendEventTrack(t,a):2==e&&this.sendFormData(t,a))},sendEventTrack:function(e,t){"object"==typeof SR&&((t="object"!=typeof t?{}:t).Form_action=e,SR.event.track(e,t))},sendFormData:function(e,t){"object"==typeof SyneriseTC&&SyneriseTC.sendFormData(e,t)}};setConversasionOngoing=function(e){contener.setAttribute("conversation-ongoing",e?"1":"0")}}function createCookieSeconds(e,t,a){var n=new Date,a=(n.setTime(n.getTime()+1e3*a),"; expires="+n.toGMTString());document.cookie=e+"="+t+a+"; path=/"}function register_tab_GUID(){if("undefined"!=typeof Storage&&"object"==typeof localStorage)try{null==sessionStorage.tabGUID&&(sessionStorage.tabGUID=tab_GUID());var e=sessionStorage.tabGUID;window.addEventListener("storage",storage_Handler,!1),localStorage.tabGUID=e}catch(e){Storage.prototype._setItem=Storage.prototype.setItem,Storage.prototype.setItem=function(){}}}function storage_Handler(e){"tabGUID"==e.key&&e.oldValue!=e.newValue&&tab_Warning()}function tab_GUID(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function tab_Warning(){anotherTab=!0}function setNewUserData(e,t,a){var n={};e&&(n.login=userLogin=client_name=e),t&&(n.email=userEmail=client_email=t),(e||t)&&(postMessage("getUserData",{email:userEmail,name:userLogin}),socket.emit("ToServerClientSaveData",{clientHash:chatHash,adminHash:window.$czater.tok,data:n})),a&&(additionParams=a,sendAdditionParams())}function tryNewUserData(){if(ifKruk){var e=document.querySelector('[ui-sref="app.modal.mail.inbox"]');if(e&&e.childNodes)for(var t in e.childNodes){t=e.childNodes[t];t&&"ng-binding"===t.className&&"string"==typeof t.innerText&&setNewUserData(t.innerText.trim().replace("\n"," "),!1,{"Dane pobrane z eKruk":"tak"})}}}function setWindowUrlVar(e){windowedUrl="offline"!==e||isSections||always?base_url+"chat/getClientChat/"+tempHash+"/"+window.$czater.tok+"/"+language+"/"+currentWidget.idWidget+"?":base_url+"chat/getEmailForm/"+tempHash+"/"+window.$czater.tok+"/"+language+"/0/0/false/"+currentWidget.idWidget+"?",""!==allegroReferer&&(windowedUrl+="allegroReferer="+allegroReferer+"&"),set_windowed&&(windowedUrl+="windowed=1&"),set_chat_color&&(windowedUrl+="chat_color="+set_chat_color+"&"),set_message_color&&(windowedUrl+="message_color="+set_message_color+"&"),set_button_color&&(windowedUrl+="button_color="+set_button_color+"&"),set_button_hover_color&&(windowedUrl+="button_hover_color="+set_button_hover_color+"&"),set_button_text_color&&(windowedUrl+="button_text_color="+set_button_text_color+"&"),set_css_template&&(windowedUrl+="css_template="+set_css_template+"&"),"&"===windowedUrl.charAt(windowedUrl.length-1)&&(windowedUrl=windowedUrl.substring(0,windowedUrl.length-1))}function prepareHost(e){return e="/"===(e=0===(e=0===(e=0===(e=(e=e.trim()).toLowerCase()).indexOf("http://")?e.substring(7):e).indexOf("https://")?e.substring(8):e).indexOf("www.")?e.substring(4):e)[e.length-1]?e.substring(0,e.length-1):e}function isExcluded(e){var t=prepareHost(document.URL);if(isMobile.any()){if(isMobile.any())for(var a in e.exclusionsMobile)if(e.exclusionsMobile[a][0]){n=e.exclusionsMobile[a][0].toLowerCase();if(1===e.exclusionsMobile[a][1]&&-1!==t.indexOf(n))return!0;if(t===n)return!0}}else for(var a in e.exclusionsDesktop)if(e.exclusionsDesktop[a][0]){var n=e.exclusionsDesktop[a][0].toLowerCase();if(1===e.exclusionsDesktop[a][1]&&-1!==t.indexOf(n))return!0;if(t===n)return!0}return!1}function checkExcluded(){null!==all&&(all.style.display=excluded?"none":"block")}function checkReferer(t,e){var e=e.split("|"),a=!1;return e.forEach(function(e){-1<prepareHost(t).indexOf(prepareHost(e))&&(a=!0)}),a}function newGetStatus(){null===chosenSection&&(headerMSG.innerHTML=button_online),socket.emit("ToServerNewGetStatus",{adminHash:window.$czater.tok,clientHash:chatHash,host:location.href,language:language,chosenSection:chosenSection||0,convInProgress:convInProgress,simpleStatus:simpleStatus,patron:patron,forceBot:forceBot})}function updateUnreadMessages(e){null==e||"0"==chatUnreadBadge||"1"!=contener.getAttribute("conversation-ongoing")&&"reset"!==e||("add"===e?(unreadMessagesCount++,"off"===contener.getAttribute("data-display")&&"flex"!==unreadBadge.style.display&&(unreadBadge.style.display="flex")):"reset"===e?(unreadMessagesCount=0,unreadBadge.style.display="none"):"show"===e&&0!==unreadMessagesCount&&null!==unreadMessagesCount?unreadBadge.style.display="flex":"hide"===e&&(unreadBadge.style.display="none"),unreadBadge.innerHTML=unreadMessagesCount)}function checkRefererPlace(t,e){void 0===t&&(t="");var e=(e=void 0===e?"":e).split("|"),a={found:!1,length:-1};return e.forEach(function(e){-1<prepareHost(t).indexOf(prepareHost(e))&&e.length>a.length&&(a={found:!0,length:e.length})}),a}function runTriggers(){if(!(-1<document.URL.indexOf("/chat/getChatWindowed/"))){var a,n,e,o=allTriggers["show-chat"],l=allTriggers["display-advert"],d=allTriggers["display-advert-footer"],i=allTriggers["callback-popup"],t=allTriggers["user-involving"];if(o&&(a=null,n=-1,Object.keys(o).forEach(function(e){var e=o[e],t=checkRefererPlace(referer,e.referer);(t.found&&t.length>n||!a&&t.found)&&(a=e,n=t.length)}),a)&&(null===a.dateUsed||"allTheTime"===a.type||"everyRefresh"===a.type)&&("all"===a.mode||"desktop"===a.mode&&!isMobile.any()||"mobile"===a.mode&&isMobile.any())&&("newClient"===a.type&&1==a.sessionCounter||"returningClient"===a.type&&1<a.sessionCounter||"allTheTime"===a.type||"everyRefresh"===a.type)&&(m=function(){var e,t=getComputedStyle(document.getElementById("czater-contener"));"none"!==t.display&&"hidden"!==t.visibility&&triggerWelcomeSelect&&(t=readCookie(cookie_prefix+cookie_trigger_used+a.idTrigger),"everyRefresh"!==a.type&&null!==t&&t==a.sessionCounter||"on"===contener.getAttribute("data-display")||(createCookie(cookie_prefix+cookie_trigger_used+a.idTrigger,a.sessionCounter,CookieTTL),"online"!==userStatus&&0!=a.online)||(teaser&&(teaser.classList.add("e3D18r_fadeout"),setTimeout(function(){teaser.classList.add("hidden")},1e3),setTimeout(function(){teaser.style.display="none"},1300)),null!==a.idSection&&setTimeout(function(){postMessage("selectSection",a.idSection)},1e3),czaterEvents.sendEvent("triggerWelcome"),socket.emit("ToServerSetTriggerUsed",{clientHash:chatHash,adminHash:window.$czater.tok,id:a.idTrigger}),a.dateUsed=1,showTitle&&setTimeout(function(){startTitleInterval()},300),a.sound&&postMessage("playSound",""),t=a.welcome,""!==(t=""!=overwriteWelcomeMessage?overwriteWelcomeMessage:t)&&"off"===contener.getAttribute("data-display")&&(clearTimeout(teaser_timeout),all.querySelector("#welcome_text_inside").innerHTML=t,avatar_online&&((e=avatar_online.split(" ")).splice(1,0,'class="welcome-avatar"'),all.querySelector("#welcome_text_inside").innerHTML+=e.join(" ")),all.querySelector("#trigger-welcome").style.display="block",setTimeout(function(){all.querySelector("#trigger-welcome").classList.remove("hidden")},500),e=null==username?"":username,all.querySelector("#welcome_name").innerHTML=e,postMessage("welcomeTrigger",t))))},0<=(r=parseInt(a.delay))&&setTimeout(m,1e3*r),0<=(r=parseInt(a.scroll))&&callIfUserScrolls(r,m),1==a.leaving)&&callIfUserLeaves(m),l&&Object.keys(l).forEach(function(s){var e,t,c=l[s];checkReferer(referer,c.referer)&&(null===c.dateUsed||"allTheTime"===c.type||"everyRefresh"===c.type)&&("all"===c.mode||"desktop"===c.mode&&!isMobile.any()||"mobile"===c.mode&&isMobile.any())&&("newClient"===c.type&&1==c.sessionCounter||"returningClient"===c.type&&1<c.sessionCounter||"allTheTime"===c.type||"everyRefresh"===c.type)&&(e=function(){var e=readCookie(cookie_prefix+cookie_trigger_used+c.idTrigger);if("everyRefresh"===c.type||null===e||e!=c.sessionCounter){createCookie(cookie_prefix+cookie_trigger_used+c.idTrigger,c.sessionCounter,CookieTTL);var e=document.createElement("div"),t=(e.setAttribute("id","gray"),e.setAttribute("class","grayCzaterSheet"),e.onclick=function(e){"gray"===e.target.parentNode.id&&this.parentNode.removeChild(this)},document.createElement("div")),a=(e.appendChild(t),document.createElement("div")),n=(a.setAttribute("id","e3D18r-modal"),a.setAttribute("class","e3D18r-modal"),c.header),o=c.text;if(""!=overwriteAdvertHeader&&(n=overwriteAdvertHeader),null==(o=""!=overwriteAdvertText?overwriteAdvertText:o)&&(o=""),e&&t&&a&&o){a.innerHTML='<div id="e3D18r-modal-header">'+n+'</div><div id="e3D18r-modal-content">'+o+"</div>"+d,t.appendChild(a),document.getElementById("e3D18r_czater").appendChild(e),czaterEvents.sendEvent("triggerPopup"),socket.emit("ToServerSetTriggerUsed",{clientHash:chatHash,adminHash:window.$czater.tok,id:c.idTrigger}),l[s].dateUsed=1,c.sound&&postMessage("playSound","");for(var i=document.getElementsByClassName("e3D18r-modal-close"),r=0;r<i.length;r++)i[r].onclick=function(e){for(var t=document.getElementsByClassName("grayCzaterSheet");0<t.length;)t[0].parentNode.removeChild(t[0])}}}},0<=(t=parseInt(c.delay))&&setTimeout(e,1e3*t),0<=(t=parseInt(c.scroll))&&callIfUserScrolls(t,e),1==c.leaving)&&callIfUserLeaves(e)}),i&&"undefined"!=typeof czatercall&&(e=setInterval(function(){czatercall.bannerReady&&(clearInterval(e),Object.keys(i).forEach(function(t){var e,a,n=i[t];checkReferer(referer,n.referer)&&(null===n.dateUsed||"allTheTime"===n.type||"everyRefresh"===n.type)&&("all"===n.mode||"desktop"===n.mode&&!isMobile.any()||"mobile"===n.mode&&isMobile.any())&&("newClient"===n.type&&1==n.sessionCounter||"returningClient"===n.type&&1<n.sessionCounter||"allTheTime"===n.type||"everyRefresh"===n.type)&&(e=function(){var e=readCookie(cookie_prefix+cookie_trigger_used+n.idTrigger);"everyRefresh"!==n.type&&null!==e&&e==n.sessionCounter||(createCookie(cookie_prefix+cookie_trigger_used+n.idTrigger,n.sessionCounter,CookieTTL),e3D18r_czater.sessionStorage.setItem("czatercallTrigger","true"),toggleCallBanner(1),socket.emit("CallbackServer",{type:"checkAvailability",adminHash:window.$czater.tok,timezoneOffset:-(new Date).getTimezoneOffset()/60,chatHash:chatHash}),czaterEvents.sendEvent("triggerCallbackInvitation"),socket.emit("ToServerSetTriggerUsed",{clientHash:chatHash,adminHash:window.$czater.tok,id:n.idTrigger}),i[t].dateUsed=1,n.sound&&postMessage("playSound",""))},0<=(a=parseInt(n.delay))&&setTimeout(e,1e3*a),0<=(a=parseInt(n.scroll))&&callIfUserScrolls(a,e),1==n.leaving)&&callIfUserLeaves(e)}))},1e3)),t&&!checkIsInvolvingActionBlocked()){var r=pickInvolvingActionReferer(t);if(r.found){var s,c=r.found,u={},m=!1;try{u=JSON.parse(c.text)}catch(e){m=!0}if(!m){for(var h in u)0===u[h].active?delete u[h]:(null==(s=e3D18r_czater.localStorage.getItem("e3D18r-triggers-"+c.idTrigger+"-"+h))&&(e3D18r_czater.localStorage.setItem("e3D18r-triggers-"+c.idTrigger+"-"+h,0),s=0),u[h].usesCount=s);socket.emit("ToServerGetUserInvolving",{clientHash:chatHash,adminHash:window.$czater.tok,id:c.idTrigger,trigger:u,referer:referer})}}}}}function pickInvolvingActionReferer(a){var n={found:!1,length:0};return Object.keys(a).forEach(function(e){e=a[e];let t=!1;e.referer.split("|").map(e=>t=prepareHost(referer).includes(prepareHost(e))),t&&n.length<=e.referer.length&&("all"===e.mode||"desktop"===e.mode&&!isMobile.any()||"mobile"===e.mode&&isMobile.any())&&(n.found=e,n.length=e.referer.length)}),n}function checkIsInvolvingActionBlocked(){var e=(new Date).getTime();return e3D18r_czater.localStorage&&e3D18r_czater.localStorage.getItem("involvingActionBlockade")&&parseInt(e3D18r_czater.localStorage.getItem("involvingActionBlockade"))+864e5>e}function blockInvolvingAction(){var e=(new Date).getTime();e3D18r_czater.localStorage.setItem("involvingActionBlockade",e)}function unblockInvolvingAction(){e3D18r_czater.localStorage.removeItem("involvingActionBlockade")}function getLastDisplayedInvAct(e){return e3D18r_czater.localStorage.getItem("e3D18r-triggers-last-use-"+e)}function setLastDisplayedInvAct(e,t){e3D18r_czater.localStorage.setItem("e3D18r-triggers-last-use-"+e,t)}function startInvolvingAction(e){0==e.delay&&(e.delay=1);var t,a,n=getLastDisplayedInvAct(e.id),o=!1;e.trigger.involvingType5&&"involvingType5"!=n?o="involvingType5":e.trigger.involvingType1&&"involvingType1"!=n?o="involvingType1":e.trigger.involvingType2&&"involvingType2"!=n?o="involvingType2":e.trigger.involvingType3&&"involvingType3"!=n?o="involvingType3":e.trigger.involvingType4&&"involvingType4"!=n&&(o="involvingType4"),o?(setLastDisplayedInvAct(e.id,o),czaterEvents.sendEvent("triggerUserInvolving"),socket.emit("ToServerSetTriggerUsed",{clientHash:chatHash,adminHash:window.$czater.tok,id:e.id}),(t=document.createElement("div")).setAttribute("id","e3D18r-user-involving-action"),n=window.innerWidth,t.classList.add("czater-main-bg"),t.classList.add("czater-main-txt"),chatInvitationPosition&&769<n?t.setAttribute("czater-inv-act-position","higher"):t.setAttribute("czater-inv-act-position","lower"),769<n?1==chat_position||3==chat_position?t.setAttribute("czater-inv-act-side","left"):t.setAttribute("czater-inv-act-side","right"):1==chat_mobile_position||3==chat_mobile_position?t.setAttribute("czater-inv-act-side","left"):t.setAttribute("czater-inv-act-side","right"),t.setAttribute("czater-inv-act-state","off"),t.innerHTML=e.trigger[o].message,document.getElementById("e3D18r_czater").appendChild(t),n=document.createElement("div"),a=document.createElement("div"),n.classList.add("class","e3D18r-icon-bundle"),n.classList.add("class","e3D18r-involving-close"),a.classList.add("e3D18r-icon-bundle"),a.classList.add("e3D18r-involving-icon"),"black"===text_msg_color?(n.classList.add("class","e3D18r-icon-zamknij_black"),"involvingType5"==o?a.classList.add("e3D18r-icon-basket-black"):a.classList.add("e3D18r-icon-eye-black")):(n.classList.add("class","e3D18r-icon-zamknij"),"involvingType5"==o?a.classList.add("e3D18r-icon-basket-white"):a.classList.add("e3D18r-icon-eye-white")),t.appendChild(n),t.appendChild(a),setTimeout(function(){t.setAttribute("czater-inv-act-state","on")},3e3),setTimeout(function(){t.setAttribute("czater-inv-act-state","off")},14e3),t.onclick=function(e){blockInvolvingAction(),t.setAttribute("czater-inv-act-state","off")}):setLastDisplayedInvAct(e.id,"")}function changeNavigation(){"black"===text_msg_color&&(minimize.className="e3D18r-icon-bundle e3D18r-icon-zmniejsz_black",windowed.className="e3D18r-icon-bundle e3D18r-icon-w-oknie_black",null!==contenerTeaserCaption&&(contenerTeaserClose.className="e3D18r-icon-bundle e3D18r-icon-zamknij_black"),closeConversation.className="e3D18r-icon-bundle e3D18r-icon-zamknij_black",czaterReturn.innerHTML='<div class="e3D18r-icon-bundle e3D18r-icon-arrow_black"></div>')}function postMessage(e,t){iframeWindow&&iframeWindow.postMessage(JSON.stringify({type:e,value:t}),"*")}function b64DecodeUnicode(e){decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function sendAdditionParams(){additionParams&&socket.emit("ToServerAdditionParams",{adminHash:window.$czater.tok,clientHash:chatHash,additionParams:additionParams})}function ToServerCheckStatus(){-1<document.URL.indexOf("getChatWindowed")&&(referer=document.referrer);var e=myCache.getCache(myCache.constants.timestamp),t=myCache.getCache(myCache.constants.exclusionsDesktop);socket.emit("ToServerCheckStatus",{consultantID:window.$czater.tok,language:language,baseUrl:base_url,size:{width:w,height:h},url:referer,referer:referer,firstReferer:firstReferer,chatHash:chatHash,chatOpen:"1"===readCookie(cookie_prefix+cookie_open),client_name:userLogin,client_email:userEmail,cachedExclusion:!!t,cacheTimestamp:e,forceBot:forceBot})}function toggleCallBanner(e){czatercall.swapView(e),1==e?(socket.emit("CallbackServer",{type:"checkAvailability",adminHash:window.$czater.tok,timezoneOffset:-(new Date).getTimezoneOffset()/60,chatHash:chatHash}),socket.emit("ToServerGetLocation",{list:[ip]}),czaterEvents.sendEvent("showCallBanner")):czaterEvents.sendEvent("hideCallBanner")}function WindowMessageListener(e){try{var t,a,n="";try{n=JSON.parse(e.data)}catch(e){}if("preloadIframe"===n.type&&((t=document.getElementById("preloadIframe")).parentNode.removeChild(t),window.screen.width||window.screen.availWidth||window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.screen.height||window.screen.availHeight||window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,!n.value||forceCookie||clientPerDomain||(chatHash=n.value),setTimeout(function(){ToServerCheckStatus(),sendAdditionParams()},1)),"chatIcon"!==n.type||document.getElementById("e3D18r-icon-promo-style")||((a=document.createElement("style")).setAttribute("id","e3D18r-icon-promo-style"),a.innerHTML=".e3D18r-icon-promo { "+n.value.icon+" }",document.body.appendChild(a),function e(t,a){"object"==typeof czatercall&&czatercall.bannerReady?czatercall.send("banner","chatIcon",t.value):a<5&&(a++,setTimeout(function(){e(t,a)},1e3))}(n,0)),"removeData"===n.type&&(client_name=client_email=""),"userSaveData"===n.type&&(void 0!==n.value.name&&(client_name=n.value.name),void 0!==n.value.email&&(client_email=n.value.email),userLogin&&""!==userLogin.trim()&&(client_name=userLogin),userEmail&&""!==userEmail.trim()&&(client_email=userEmail),newGetStatus(),socket.emit("ToServerClientSaveData",{clientHash:chatHash,adminHash:window.$czater.tok,data:n.value}),sendAdditionParams()),"clientLoggedIn"===n.type&&("logged_in"===n.value&&socket.emit("queueClientHash",{adminHash:window.$czater.tok,clientHash:chatHash,email:client_email,reliable:window.$czater.email&&window.$czater.email===client_email?1:0}),createCookie(cookie_prefix+cookie_client_logged,1,CookieTTL)),"clientLoggedOut"===n.type&&createCookie(cookie_prefix+cookie_client_logged,0,CookieTTL),"frameLoaded"===n.type&&(isSections=parseInt(n.isSections),messagesCount=parseInt(n.messages),iframeNewMessage=document.getElementById("czater-iframe"),iframeParent=iframeNewMessage.parentNode,iframeWindow=iframeNewMessage.contentWindow||iframeNewMessage,postMessage("internet",{internet:!0,chosenSection:chosenSection}),postMessage("getUserData",{email:userEmail,name:userLogin,emailReadOnly:!!window.$czater.email,nameReadOnly:!!window.$czater.login}),client_email&&null!=client_email&&void 0!==client_email&&"undefined"!==client_email||(client_email=""),null===(client_name=client_name&&null!=client_name&&void 0!==client_name&&"undefined"!==client_name?client_name:"")&&null===client_email&&socket.emit("ToServerGetUserData",{chatHash:chatHash,consultantID:window.$czater.tok,base_url:base_url}),userLogin&&""!==userLogin.trim()&&(client_name=userLogin),userEmail&&""!==userEmail.trim()&&(client_email=userEmail),frameLoadedDetail.userLogin=client_name,frameLoadedDetail.userEmail=client_email,frameLoadedDetail.hideBrand=hideBrand,frameLoadedDetail.specialReferer=httpRef||referer,frameLoadedDetail.userSection=userSection,frameLoadedDetail.forceOffline=forceOffline,frameLoadedDetail.clientCustomFields=clientCustomFields,frameLoadedDetail.idSectionDefault=idSectionDefault,frameLoadedDetail.templateData=templateData,frameLoadedDetail.set_css_template=set_css_template,frameLoadedDetail.externalCSS=externalCSS,frameLoadedDetail.overwriteWelcomeOnline=overwriteWelcomeOnline,frameLoadedDetail.overwriteWelcomeOffline=overwriteWelcomeOffline,frameLoadedDetail.isClientRegisterOn=clientRegister,frameLoadedDetail.clientRegisterAgreement=clientRegisterAgreement,frameLoadedDetail.isClientLogged=1==readCookie(cookie_prefix+cookie_client_logged),frameLoadedDetail.chatbotsForms=chatbotsForms,postMessage("templateLoaded",frameLoadedDetail),firstRefererSent&&(firstRefererSent=!1,runTriggers(),!1!==userSection)&&postMessage("selectSection",userSection),""!==allegroReferer&&postMessage("allegroReferer",allegroReferer),postMessage("isNowOnline","offline"!==userStatus),contener.style.visibility="visible",socket.emit("queueClientHash",{adminHash:$czater.tok,clientHash:tempHash,email:client_email,reliable:window.$czater.email&&window.$czater.email===client_email?1:0}),socket.emit("getMsgReadByConsultant",{adminHash:$czater.tok,clientHash:tempHash}),absolutelyFirst)&&(absolutelyFirst=!1,newGetStatus()),"convInProgress"===n.type&&(convInProgress=1,simpleStatus=0,e3D18r_czater.localStorage.setItem("simpleStatus",0),chosenSection=n.value.idSection),"newGetStatus"===n.type&&newGetStatus(),"ClientSendMessage"===n.type){if(anotherTab&&!n.value.isCodeValid)return;userLogin&&""!==userLogin.trim()&&(n.value.clientNameInput=userLogin.trim()),userEmail&&""!==userEmail.trim()&&(n.value.clientEmailInput=userEmail.trim()),n.value.referer=referer,"SPACEARMY"===n.value.message&&(n.value.message="https://spacearmy.swy.pl"),n.value.isCodeValid&&0!=convInProgress&&socket.emit("ContinuePaidChat",n.value.code,chatHash),1!=convInProgress&&(newGetStatus(),convInProgress=1,setTimeout(function(){sendAdditionParams()},1e3)),n.value.reliable=window.$czater.email&&window.$czater.email===n.value.clientEmailInput?1:0,forceBot&&(n.value.forceBot=patron),simpleStatus=0,e3D18r_czater.localStorage.setItem("simpleStatus",0),socket.emit("ToServerClientSendMessage",n.value)}if("turnOnPreview"===n.type&&socket.emit("toServerClientTurnedPreview",n.value),"ClientGetSection"===n.type&&(chosenSection=0===n.value.department.id?null:n.value.department.id,changeFirstMessage(),n.value.baseUrl=base_url,n.value.language=language,0!==n.value.department.id&&document.getElementById("czaterReturn")&&(document.getElementById("czaterReturn").style.display="block"),newGetStatus()),"chatSectionChanged"===n.type&&czaterEvents.sendEvent("chatSectionChanged",{idSection:n.value.section}),"ClientWriting"===n.type&&(anotherTab&&(anotherTab=!1,register_tab_GUID()),n.value.adminHash=window.$czater.tok,socket.emit("ToServerClientWriting",n.value)),"MarkConversation"===n.type&&socket.emit("ToServerMarkConversation",n.value),"letToChoose"===n.type&&(firstRefererSent=!0,iframeNewMessage.remove(),iframeNewMessage.setAttribute("src",base_url+"chat/getClientChat/"+tempHash+"/"+window.$czater.tok+"/"+language+"/"+currentWidget.idWidget+"?"+(set_css_template?"css_template="+set_css_template+"&":"")),iframeParent.append(iframeNewMessage)),"letToChoose2"===n.type&&(iframeNewMessage.remove(),iframeNewMessage.setAttribute("src",base_url+"chat/getClientChat/"+tempHash+"/"+window.$czater.tok+"/"+language+"/"+currentWidget.idWidget+"?"+(set_css_template?"css_template="+set_css_template+"&":"")),iframeParent.append(iframeNewMessage)),"queueClientHashDone"===n.type&&refreshPage(),"changeLocation"===n.type){if(iframeNewMessage.getAttribute("src")+"#"==n.value)return;iframeNewMessage.remove(),iframeNewMessage.setAttribute("src",n.value),iframeParent.append(iframeNewMessage)}if("showReturnButton"===n.type&&document.getElementById("czaterReturn")&&(document.getElementById("czaterReturn").style.display="block"),"36177_log"===n.type&&"7ddbd98970f762b3e25003a6e5841e582f4147fe"===window.$czater.tok&&socket.emit("toServerLogDebug",{value:n.value}),"changeHeader"===n.type&&"on"===contener.getAttribute("data-display")&&("offline"===n.mode?header_content=header_online:(header_content=header_online,avatar.innerHTML=button_online),headerMSG.innerHTML=header_content),"hideReturnButton"===n.type&&document.getElementById("czaterReturn")&&(document.getElementById("czaterReturn").style.display="none"),"readMessagesByClient"===n.type&&(stopTitleInterval(),updateUnreadMessages("reset"),document.hidden||socket.emit("readMessagesByClient",{adminHash:window.$czater.tok,clientHash:chatHash})),"czatercallMessage"===n.type){var o=n.value;switch(o.type){case"switchView":toggleCallBanner(o.switch);break;case"callbackReady":czaterEvents.sendEvent("callbackReady");break;case"readiness":czaterCallbackUserSection=czaterCallbackUserSection||!1,czatercall.listnerReadiness(o.value,czaterCallbackUserSection);break;case"isOver":socket.emit("CallbackServer",{type:"isOver",call:o.call});break;case"callsRating":socket.emit("CallbackServer",{type:"survey",call:o.call,mark:o.mark,comment:o.comment});break;case"verifyNumber":socket.emit("CallbackServer",{type:"verifyNumber",number:o.number,from:o.from});break;case"requestCall":czatercall.number=o.number,"now"===o.when?czaterEvents.sendEvent("callRequest"):czaterEvents.sendEvent("callRequestLater"),socket.emit("CallbackServer",{type:"clientCall",call:null,callsType:o.callsType,mode:"multi",adminHash:window.$czater.tok,chatHash:chatHash,section:o.section,patron:patron,number:o.number,when:o.when,timezoneOffset:-(new Date).getTimezoneOffset()/60,referer:window.location.href||document.URL});break;case"showTeaser":1==o.value?czatercall_teaser.style.visibility="visible":czatercall_teaser.style.visibility="hidden";break;case"clientData":postMessage("editClientData",o.toSend);break;case"getCallStatus":socket.emit("getCallStatus",{adminHash:window.$czater.tok,idSection:o.idSection,timezoneOffset:-(new Date).getTimezoneOffset()/60});break;case"checkAvailability":socket.emit("CallbackServer",{type:"checkAvailability",adminHash:window.$czater.tok,timezoneOffset:-(new Date).getTimezoneOffset()/60,chatHash:chatHash,code:o.code});break;case"checkCode":socket.emit("CallbackServer",{type:"checkCode",code:o.code})}}"googleAnalytics"===n.type&&czaterEvents.sendEvent(n.value),"syneriseEvent"===n.type&&czaterSR.sendCustomRequest(n.value.kind,n.value.name,n.value.params),"messageOfflineSend"===n.type&&doCloseConversation(),"surveyDone"===n.type&&socket.emit("saveSurvey",n.value),"getPrevMessages"===n.type&&socket.emit("getPrevMessages",{adminHash:window.$czater.tok,clientHash:chatHash,idSection:n.value.idSection,lastMessageId:n.value.lastMessageId},function(e){postMessage("setPrevMessages",e)})}catch(e){console.error("!!!",e)}}function slideToggle(){var e=document.getElementById("closeConversationMenu");open?(open=!1,e.style.display="none"):(open=!0,e.style.display="inline")}function loadCSS(e){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),head.appendChild(t)}function loadScript(e,t){var a=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=t,a.appendChild(n)}function changeFirstMessage(){null===welcomeMsg||null===welcome_offlineMsg||null===sectionsStatus||convInProgress||(sectionsStatus[chosenSection]&&"offline"==sectionsStatus[chosenSection].consultantStatus?postMessage("welcomeTrigger",ifKruk?"Dzień dobry w tej chwili nasi doradcy są zajęci, prosimy o cierpliwe oczekiwanie na rozpoczęcie konwersacji":welcome_offlineMsg):postMessage("welcomeTrigger",welcomeMsg))}function getStatus(e){(frameLoadedDetail={}).status=e,username=e.username,previousStatusData=e,isMobile.any()&&("offline"===e.status?e.button=e.mobile_offline_button:e.button=e.mobile_online_button),null===e.idConsultant&&isAvatar&&(isAvatar=!1,avatar.innerHTML=""),e.button&&"on"!==contener.getAttribute("data-display")&&(headerMSG.innerHTML=e.button),userStatus!==e.status&&"offline"===e.status&&1!=always&&(isAvatar=!1,idConsultant=null),avatar_online=e.avatar?1.5<window.devicePixelRatio?e.avatar.big:e.avatar.small:"",0==e.sectionsCount&&(chosenSection="0"),idConsultant=e.idConsultant,e.bot&&!e.isOnlyBots&&(e.convInProgress||convInProgress)&&(e.header+=' <div id="switch-conv-from-bot" title="'+switch_from_bot+'"> <div class="e3D18r-icon-bundle e3D18r-icon-bot-to-consultant"></div></div>'),header_consultant=e.header,header_online="online"==e.status?e.online_header:e.offline_header,button_online=e.button;var t,a=contener.getAttribute("data-display");"off"===a?headerMSG.innerHTML!=button_online&&(headerMSG.innerHTML=button_online):null===chosenSection&&0<e.sectionsCount?(headerMSG.innerHTML=header_online,isAvatar=!1,avatar.innerHTML=""):headerMSG.innerHTML!=header_consultant&&(headerMSG.innerHTML=header_consultant),userStatus===e.status&&isAvatar&&header_online===e.header&&!e.bot||(isAvatar=!1,avatar.innerHTML="",userStatus=e.status,t="","black"===text_msg_color?(t=1==e.always||"online"==userStatus?"e3D18r-icon-message_black":"e3D18r-icon-message_offline_1_black",status.setAttribute("class","black czater-status czater-status-"+(1!=e.always?userStatus:"online")+" e3D18r-icon-bundle "+t)):(t=1==e.always||"online"==userStatus?"e3D18r-icon-message":"e3D18r-icon-message_offline_1",status.setAttribute("class","czater-status czater-status-"+(1!=e.always?userStatus:"online")+" e3D18r-icon-bundle "+t)),1!=e.always?contener.setAttribute("data-status",e.status):contener.setAttribute("data-status","online"),!e.avatar||"off"!==a&&null===chosenSection?(headerMSG.classList.remove("withAvatar"),headerMSG.classList.add("withoutAvatar")):(isAvatar=!0,1.5<window.devicePixelRatio?avatar.innerHTML=e.avatar.big:avatar.innerHTML=e.avatar.small,"on"===a&&isAvatar&&(headerMSG.classList.remove("withoutAvatar"),headerMSG.classList.add("withAvatar"))),0<e.countNewMessages&&(countNewMessages.innerHTML=e.countNewMessages,"black"===text_msg_color?countNewMessages.setAttribute("class","black czater-status czater-enable"):countNewMessages.setAttribute("class","czater-status czater-enable"))),postMessage("isBot",e.bot&&(e.convInProgress||convInProgress)),postMessage("isNowOnline","offline"!==userStatus)}function updateTemplate(r){function e(){var e;if(r.template.timestamp,document.getElementById("deferred-styles"),isMobile.any()&&((o=document.createElement("link")).setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",static_url+"assets/modules/chat/css/chat_mobile.css"),all.insertBefore(o,all.childNodes[0])),Array.isArray(externalCSS))for(var t=0;t<externalCSS.length;t++){var a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href",externalCSS[t]),all.insertBefore(a,all.childNodes[0])}if(Array.isArray(r.template.css)){urls=r.template.css;for(t=0;t<urls.length;++t){var n=urls[t];n.auto&&((e=document.createElement("link")).setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",static_url+"assets/css/advanced/"+window.$czater.tok+"_"+n.name+".min.css"),all.insertBefore(e,all.childNodes[0]))}}(o=document.createElement("link")).setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",static_url+"assets/modules/chat/css/icons/icons.data.svg.css"),o.setAttribute("as","style"),o.setAttribute("data-e3D18r-css-loaded","false"),o.setAttribute("onload","this.setAttribute('data-e3D18r-css-loaded', 'true')"),cssLoaded=o,all.insertBefore(o,all.childNodes[0]),(o=document.createElement("link")).setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",static_url+"assets/modules/chat/css/chat"+r.newLayout+"_outside.css"),all.insertBefore(o,all.childNodes[0]);(o=document.createElement("link")).setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",static_url+"assets/css/user/"+window.$czater.tok+"_language.min.css"),all.insertBefore(o,all.childNodes[0]);var o=r.template.widgets.hash,i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",static_url+"assets/css/user/"+o+".min.css"),all.insertBefore(i,all.childNodes[0])}var t,a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,a=(a?a(function(){window.setTimeout(e,0)}):window.addEventListener("load",e),all=document.getElementById(r.template.prefix+"_czater"),iframeNewMessage=all.querySelector("#czater-iframe"),header=all.querySelector("#chatHeader"),unreadBadge=all.querySelector("#unreadBadge"),status=all.querySelector("#status"),avatar=all.querySelector("#e3D18r-avatar")||all.querySelector("#avatar"),headerMSG=all.querySelector("#headerMSG"),contener=all.querySelector("#czater-contener"),teaser=all.querySelector("#teaser"),czatercall_teaser=all.querySelector("#czatercall-teaser"),czatercall_teaser_caption=all.querySelector("#czatercall-teaser_caption"),czatercall_teaser_button=all.querySelector("#czatercall-teaser-button"),welcomeCloseSelect=all.querySelector("#welcome_close"),triggerWelcomeSelect=all.querySelector("#trigger-welcome"),null!==teaser&&(t=(new Date).getTime(),readCookie(cookie_prefix+teaser_shown)?teaser.classList.remove("hidden"):teaser_timeout=setTimeout(function(){createCookie(cookie_prefix+teaser_shown,t,1),teaser.classList.add("e3D18r_fadein"),teaser.classList.remove("hidden")},5e3)),null!==czatercall_teaser&&(null==e3D18r_czater.localStorage.czatercall_teaser&&e3D18r_czater.localStorage.setItem("czatercall_teaser","0"),a=all.querySelector("#czatercall-teaser_close"),czatercall_teaser_caption.onclick=function(){null!==czatercall_teaser&&(czatercall_teaser.style.display="none"),"undefined"!=typeof czatercall&&(socket.emit("CallbackServer",{type:"checkAvailability",adminHash:window.$czater.tok,timezoneOffset:-(new Date).getTimezoneOffset()/60,chatHash:chatHash}),toggleCallBanner(1),czaterEvents.sendEvent("showCallBanner"))},a.onclick=function(){null!==czatercall_teaser&&(e3D18r_czater.localStorage.setItem("czatercall_teaser","1"),czatercall_teaser.style.display="none")},!isMobile.any())&&769<window.innerWidth&&"1"!=e3D18r_czater.localStorage.getItem("czatercall_teaser")&&setTimeout(function(){"undefined"!=typeof czatercall&&"block"!=czatercall.iBanner.style.display&&(czatercall_teaser.classList.add("e3D18r_fadein"),czatercall_teaser.classList.remove("hidden"),czatercall_teaser.style.display="flex")},5e3),contenerTeaserCaption=all.querySelector("#teaser_caption"),countNewMessages=all.querySelector("#countNewMessages"),windowed=all.querySelector("#windowed"),minimize=all.querySelector("#minimize"),closeConversation=all.querySelector("#closeConversation"),closeConversationMenu=all.querySelector("#closeConversationMenu"),contenerTeaserClose=all.querySelector("#teaser_close"),czaterReturn=all.querySelector("#czaterReturn"),document.querySelector("meta[name=viewport]"));a&&(a=a.getAttribute("content"))&&-1!==a.indexOf("width=device-width")||(noViewPort=!0),eventsStarted||events()}function updateSettings(t){var e,a;"ok"!==t.token&&(headerMSG.innerHTML=header_online=button_online="Nieprawidłowy kod czatu",window.token=!1),void 0!==t.always&&(always=t.always),clientRegister=t.clientRegister,clientRegisterAgreement=t.clientRegisterAgreement,switch_from_bot=t.switch_from_bot,t.newLayout=3,firstSettingsSent&&(firstSettingsSent=!1,window.token&&((t.exclusionDesktop&&!isMobile.any()||t.exclusionMobile&&isMobile.any())&&(all.style.display="none"),(isRecording=1===t.recordUsers&&isRecording)&&-1===window.location.href.indexOf(base_url.replace("www","proxy"))&&socket.emit("ToServerCheckIfRecord",{chatHash:chatHash,consultantID:window.$czater.tok}),t.videCalllsEnabled&&loadScript(static_url+"/assets/modules/chat/js/video-build.js",function(){setTimeout(function(){var e;t.timestamp=timestamp,t.static_url=static_url,t.videoWindowed=videoWindowed,window.$czaterMethods.startVideoWidget(t),t.showVideoButton&&((e=document.createElement("div")).setAttribute("class","e3D18r-icon-bundle e3D18r-icon-camera-white"),e.addEventListener("click",function(){$czaterMethods.toggleVideoCallBanner(!0)}),header.appendChild(e)),czaterEvents.sendEvent("videoCallReady")},1e3)}),(window.location.href.indexOf("getChatWindowed")<0||forceCallback)&&(e=myCache.getCache(myCache.constants.callLangs),a=myCache.getCache(myCache.constants.callCountries),isMobile.any()?t.callsMobileVisibility&&socket.emit("CallbackServer",{type:"start",adminHash:window.$czater.tok,language:language,time:(new Date).toISOString(),cachedCallLangs:!!e,cachedCallCountries:!!a}):socket.emit("CallbackServer",{type:"start",adminHash:window.$czater.tok,language:language,timezoneOffset:-(new Date).getTimezoneOffset()/60,cachedCallLangs:!!e,cachedCallCountries:!!a})),lang=t.lang,hideBrand=t.hideBrand,tempHash=t.hash,chat_color=t.chat_color,set_chat_color=chat_color,text_msg_color=t.text_msg_color,rounded_corners=t.rounded_corners,chat_position=t.chat_position,chat_mobile_position=t.chat_mobile_position,chatInvitationPosition=t.callsInvPosition,avatar_position=t.avatar_position,newLayout=t.newLayout,marking=t.marking,chatUnreadBadge=t.chatUnreadBadge,czaterEvents.setEnabled(t.googleAnalytics),createCookie(cookie_prefix+cookie_name+window.$czater.tok,tempHash,CookieTTL)),setWindowUrlVar(t.status),iframeNewMessage.setAttribute("referrer",window.location.href),lang=languageToCss(lang),contener.setAttribute("data-lang",lang),contener.setAttribute("data-layout",newLayout),headerClass="czater-header czater-header-normal",(isMobile.any()||1===avatar_position||-1<window.location.href.indexOf("getChatWindowed"))&&(headerClass+=" avatarInside windowed"),header.setAttribute("class",headerClass),isTeaserClosed&&null!==teaser&&(teaser.style.display="none"),!allowAutoOpen&&isMobile.any()||"1"!==readCookie(cookie_prefix+cookie_open)&&!autoOpen||isMobile.iPad()||isMobile.iPhone()?(firstCookie&&(hideChat(!1,!0),firstCookie=!1),headerClass="czater-header czater-button",2!==newLayout&&((isMobile.any()||1===avatar_position||-1<window.location.href.indexOf("getChatWindowed"))&&(headerClass+=" avatarInside"),headerClass+=" czater-height"),header.setAttribute("class",headerClass),contener.style.overflow=set_minimized_button?"hidden":"",set_minimized_button&&"off"===contener.getAttribute("data-display")?contener.style.width="41px":contener.style.width=""):firstCookie&&(hideChat(!0,!0),showChat(!0,!0),firstCookie=!1)),absolutelyFirst&&changeNavigation()}function languageToCss(e){for(var t in w4Ue7Lb)if(e===t||e===w4Ue7Lb[t][1]||e===w4Ue7Lb[t][2])return w4Ue7Lb[t][1];return"pol"}function checkChatBlock(){var e=e3D18r_czater.localStorage.getItem("czater_chatBlockedTo_"+window.location.host);let t=new Date;return t=t.getTime(),!!(e&&parseInt(e)>t)}function refreshPage(){destroy(),location.reload()}function events(){function e(){var e,t;forceBot&&doCloseConversation(),isRecording&&recorder&&recorder.events?(t=1,e=recorder.compress(JSON.stringify(recorder.events.slice(frameNumber))),socket.emit("toServerUserRecordingPart",{dateBegin:recorder.startDate,dateEnd:t,recId:recId,chatHash:chatHash,items:e,consultantHash:window.$czater.tok}),frameNumber=0,allowSend=!1):isRecording&&recorder&&(socket.emit("toServerUserRecordingPart",{dateBegin:recorder.startDate,dateEnd:t=1,recId:recId,chatHash:chatHash,consultantHash:window.$czater.tok}),frameNumber=0,allowSend=!1)}var t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),a=navigator.userAgent.match(/Lumia/i),n=navigator.userAgent.match(/Android/i),o="beforeunload";t?(o="unload",window.addEventListener(o,e)):a?(o="pagehide",window.addEventListener(o,e)):n?window.onunload=window.onbeforeunload=function(){e()}:window.addEventListener("beforeunload",e),allowMobileBack&&isMobile.any()&&window.addEventListener("hashchange",function(e){-1!==e.oldURL.indexOf("#chat-window-open")&&-1===e.newURL.indexOf("#chat-window-open")&&hideChat()}),eventsStarted=!0,window.onresize=function(e){var t;window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;"undefined"!=typeof czatercall&&czatercall.iButton&&czatercall.iButton.removeAttribute("class"),t=window.innerWidth<770?1==chat_mobile_position||3==chat_mobile_position?"attachment-mobile-bottom-left":"attachment-mobile-bottom-right":1==chat_position||3==chat_position?"attachment-bottom-left":"attachment-bottom-right","undefined"!=typeof czatercall&&czatercall.iButton&&czatercall.iButton.classList.add(t),!alreadyStarted&&isMobile.any()&&window.innerWidth>=window.innerHeight&&"offline"===userStatus?(contener.style.position="absolute",contener.style.bottom="auto",contener.style.top="0px"):(contener.style.position="",contener.style.bottom="",contener.style.top=""),!alreadyStarted&&isMobile.iPhone()&&window.innerWidth>=window.innerHeight&&window.scrollTo(0,document.body.scrollHeight)},window.onfocus=function(){anotherTab=!1,register_tab_GUID()},null!==contenerTeaserCaption&&(contenerTeaserClose.onclick=function(){createCookie(cookie_prefix+cookie_teaser_closed,"1",CookieTTL),null!==teaser&&(teaser.style.display="none"),minimizePressed=!0}),welcomeCloseSelect&&triggerWelcomeSelect&&(all.querySelector("#welcome_close").onclick=function(e){e.stopPropagation(),all.querySelector("#trigger-welcome").style.display="none"},all.querySelector("#trigger-welcome").addEventListener("click",function(){e3D18r_czater.sessionStorage.setItem("czatPopupTrigger","true")})),czaterEvents.sendEvent("chatReady"),-1!==window.location.href.indexOf("#open_chat")&&$czaterMethods.showChat(!0)}function checkInputBlockade(){isBot===bots.FAQ&&0===messagesCount||isBot===bots.FAQ&&receivedByConsultant?postMessage("blockInput",!0):postMessage("blockInput",!1)}}()}catch(e){console.error(e),"object"==typeof Rf2jK5f&&"function"==typeof Rf2jK5f.emit&&Rf2jK5f.emit("jsError",{time:(new Date).getTime(),type:"client",file:"chat.js",url:document.URL,error:JSON.stringify(e)})}